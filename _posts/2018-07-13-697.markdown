---
layout: post
title: Now Pushing Malware: NPM package dev logins slurped by hacked tool popular with coders
date: 2018-07-13 13:02:12
tourl: /2018/07/12/npm_eslint/
tags: [Source,Attack]
---
The open-source utility NPM is the Although eslint-scope has more than Version 3.7.2 of eslint-scope was pushed to NPM by miscreants who gained control of a maintainer's NPM account for the software: that's the poisoned version that harvested people's NPM login tokens. It was taken offline within two hours of going live.The credential thieves could have used the tokens to gain access to other NPM-managed projects that could, again, be used to spread more malware. NPM users download In other words, someone lost control their NPM account to an attacker, who then implanted malicious code in a popular tool maintained by that someone to gain access to NPM accounts to potentially infect further packages.Understandably, NPM has already invalidated tokens issued before 2018-07-12 1230 UTC in an attempt to prevent the further spread of evil code. Unfortunately, the damage may have already been done. NPM said "a small number" of developers, and potentially their projects, were affected by this."We believe the vector for this compromise was stolen credentials from one of the authorized publishers of the eslint-scope package," "We recommend all package authors enable two-factor auth to protect their accounts from this kind of attack."The hijack is believed to have kicked off some time last night, with an eslint-scope maintainer's account receiving a new unexpected NPM token overnight, tipping off coders to a possible security breach."One of our maintainers did observe that a new npm token was generated overnight (said maintainer was asleep)," Anyone who used the infected version of eslint-scope has, by now, had their NPM tokens revoked, so that part of the attack has been mitigated. They should also delete the software, and install a known good version.NPM said it will conduct a further audit of all of its managed projects to determine just how bad the breach really was. ŽWe understand some 4,500 login tokens were potentially swiped by the rogue JavaScript utility, although there has been no sign of any malicious activity beyond the compromise of eslint-scope. NPM's CTO CJ Silverio dropped us a note to explain:Early in the morning of July 12, an individual gained access to an npm publishers account and used this access to publish an unauthorized update of a popular package. The update included malicious code that would have attempted to access the accounts of additional npm users by obtaining these accounts access tokens.We determined that access tokens for approximately 4,500 accounts could have been obtained before we acted to close this vulnerability. However, we have not found evidence that any tokens were actually obtained or used to access any npmjs.com account during this window.As a precautionary measure, npm has revoked every access token that had been created prior to 2:30 pm UTC (7:30 am California time) today. This measure requires every registered npm user to re-authenticate to npmjs.com and generate new access tokens, but it ensures that there is no way for this mornings vulnerability to persist or spread. We are additionally conducting a full forensic analysis to confirm that no other accounts were accessed or used to publish unauthorized code.This mornings incident did not happen because of an npmjs.com breach, but because of a breach elsewhere that exposed a publishers npm credentials. To mitigate this risk, we encourage every npmjs.com user to enable two-factor authentication, with which this mornings incident would have been impossible.