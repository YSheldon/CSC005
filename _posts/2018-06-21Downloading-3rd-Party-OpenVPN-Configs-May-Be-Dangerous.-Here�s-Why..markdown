---
layout: post
title: Downloading 3rd Party OpenVPN Configs May Be Dangerous. Here’s Why.
date: 2018-06-21 15:55:54
tourl: https://www.bleepingcomputer.com/news/security/downloading-3rd-party-openvpn-configs-may-be-dangerous-here-s-why/
tags: [attack]
---
æŠŠæˆ‘ç§°ä¸ºæ„¤ä¸–å«‰ä¿—è€…ï¼Œä½†æˆ‘ä»ä½¿ç”¨äº’è”ç½‘å­¦åˆ°çš„ä¸€ä»¶äº‹æ˜¯ï¼Œä»”ç»†æ£€æŸ¥ï¼Œå¦‚æœä¸æ˜¯ä¸‰æ¬¡æ£€æŸ¥ï¼Œä½ æ‰€ä¸‹è½½çš„ä¸€åˆ‡ã€‚å¦‚æ­¤å¤šçš„ä¸‹è½½éƒ½æœ‰æ¶æ„è½¯ä»¶ã€å¹¿å‘Šè½¯ä»¶å’Œè„šæœ¬åœ¨ä½ çš„è®¡ç®—æœºä¸Šæ‰§è¡Œæ¶æ„æ´»åŠ¨ï¼Œä»¥è‡³äºå¿…é¡»åœ¨ä½¿ç”¨ä¹‹å‰å½»åº•æ£€æŸ¥ä¸‹è½½ã€‚è¿™ä¸€ç‚¹åœ¨OpenVPNä¸­æ˜¯ä¸€ä¸ªæµè¡Œçš„å¼€æºVPNç¨‹åºã€‚è¿™å…è®¸æ‚¨åœ¨è®¡ç®—æœºæˆ–è®¾å¤‡å’Œå¦ä¸€ä¸ªç½‘ç»œä¹‹é—´åˆ›å»ºå®‰å…¨å’ŒåŠ å¯†çš„ç½‘ç»œè¿æ¥ã€‚ç”±äºå®ƒçš„æ™®åŠï¼Œå®ƒå·²ç»è¢«ç§»æ¤åˆ°å„ç§å„æ ·çš„è®¾å¤‡ä¸Šï¼ŒåŒ…æ‹¬è¿è¡ŒDD-WRTçš„è·¯ç”±å™¨ã€‚ä¸ºäº†æ–¹ä¾¿è¿™ä¸€ç‚¹ï¼ŒVPNæä¾›å•†åˆ›å»ºOpenVPNé…ç½®æ–‡ä»¶ï¼Œå¯ä»¥ä¸‹è½½å’Œå®‰è£…ï¼Œä»¥ä¾¿æ–¹ä¾¿åœ°é…ç½®VPNè¿æ¥ã€‚æ ¹æ®è´æ©æ–¯ï¼Œè¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œä¸€ä¸ªåè§’è‰²éœ€è¦åšçš„æ˜¯å‘æ— å®³çš„OpenVPNé…ç½®æ–‡ä»¶ï¼ˆ.opvPNï¼‰æ·»åŠ å‡ è¡Œä»¥ä½¿å…¶æˆä¸ºæ¶æ„çš„ã€‚åœ¨è´æ©æ–¯çš„ä¾‹å­ä¸­ï¼ŒOpenVPNé…ç½®æ–‡ä»¶åªæ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œé‡Œé¢æœ‰ä¸€äº›å‘½ä»¤ï¼šå¦‚æœä¸€ä¸ªæ¼”å‘˜æƒ³è®©OpenVPNé…ç½®æ–‡ä»¶æ‰§è¡Œä¸€ä¸ªå‘½ä»¤ï¼Œä»–ä»¬ä¼šæ·»åŠ â€œå½“è¿™ä¸ªé…ç½®æ–‡ä»¶è¢«ä½¿ç”¨å¹¶ä¸”åœ¨å»ºç«‹è¿æ¥ä¹‹åï¼ŒOpenVPNå°†é€€å‡ºâ€ã€‚æŒ‰ä¸Šè¿°å‘½ä»¤åœ¨192.1681.218å‘è®¡ç®—æœºæ‰“å¼€ä¸€ä¸ªåå‘å¤–å£³ã€‚è¿™å°†å…è®¸æ”»å‡»è€…åœ¨è¯¥IPåœ°å€ä¸Šæ‰§è¡Œè¿è¡ŒOpenVPNé…ç½®æ–‡ä»¶çš„è¿œç¨‹è®¡ç®—æœºä¸Šçš„å‘½ä»¤ã€‚è´æ©æ–¯ç”šè‡³ç»§ç»­å±•ç¤ºå¦‚ä½•é€šè¿‡ä½¿ç”¨PopeScriptè„šæœ¬æ¥æ”»å‡»ä¸Šè¿°æ–¹æ³•æ¥æ”»å‡»Windowsç”¨æˆ·ã€‚Buttä¸‹è½½OpenVPNé…ç½®è‡ªç¬¬ä¸‰æ–¹ï¼Œè´æ©æ–¯å‘Šè¯‰BleepingComputerï¼Œä»–æ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„é…ç½®ç›®å‰åœ¨é‡å¤–ã€‚ç°åœ¨ï¼Œä½ çŸ¥é“OpenVPNé…ç½®å¯ä»¥ç”¨æ¥å¯¹ä»˜ä½ ï¼Œä½ å¯èƒ½æƒ³çŸ¥é“å¦‚ä½•æ£€æŸ¥ï¼Œå¦‚æœä½ ä½¿ç”¨ä»»ä½•æ¶æ„ã€‚TICLEï¼Œè´æ©æ–¯è¯´ï¼Œä½ å¯ä»¥åœ¨VPNè¿æ¥æ—¥å¿—ä¸­æ‰¾åˆ°çº¿ç´¢ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚å¦‚æœä½ åœ¨æ—¥å¿—ä¸­çœ‹åˆ°ä¸Šé¢çš„è¡Œï¼Œå®ƒæ„å‘³ç€ä½¿ç”¨â€œè„šæœ¬å®‰å…¨2â€è®¾ç½®ï¼Œå®ƒå…è®¸ç”¨æˆ·å®šä¹‰çš„è„šæœ¬è¢«æ‰§è¡Œã€‚æ­£åœ¨ç”±é…ç½®æ–‡ä»¶æ‰§è¡Œã€‚ä½ åº”è¯¥èƒ½å¤Ÿåœ¨ä¸Šé¢çš„æ—¥å¿—ä¸­æ‰¾åˆ°ç¬¬äºŒè¡Œæ‰€ç¤ºçš„å‘½ä»¤ï¼Œå› ä¸ºOpenVPNé…ç½®æ–‡ä»¶ä»…ä»…æ˜¯æ–‡æœ¬æ–‡ä»¶ï¼Œè¿˜å¯ä»¥é€šè¿‡åœ¨è®°äº‹æœ¬æˆ–å…¶ä»–æ–‡æœ¬ç¼–è¾‘å™¨ä¸­æ‰“å¼€æ–‡ä»¶æ¥æ£€æŸ¥OpenVPNé…ç½®æ˜¯å¦æ˜¯æ¶æ„çš„ã€‚è¿™å°†å…è®¸ä½ çœ‹åˆ°æ•´ä¸ªé…ç½®æ–‡ä»¶å’Œç‚¹ï¼Œå¦‚æœæœ‰ä»»ä½•å‘½ä»¤æ­£åœ¨æ‰§è¡Œã€‚ä¸å¹¸çš„æ˜¯ï¼ŒOpenVPNæœ‰å…¶ä»–çš„é…ç½®æŒ‡ä»¤ï¼Œä¹Ÿå¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œè´æ©æ–¯å»ºè®®ç”¨æˆ·ä½¿ç”¨â€œä¸å¹¸çš„æ˜¯ï¼ŒUPå‘½ä»¤ä¸æ˜¯å”¯ä¸€çš„å‘½ä»¤ï¼Œå¯ä»¥ä½¿ç”¨ã€‚â€œè¿™æ ·ï¼Œâ€è´æ©æ–¯å‘Šè¯‰BleepingComputerã€‚â€œå‘ä¸Šï¼Œå‘ä¸‹ï¼Œå®¢æˆ·ç«¯è¿æ¥ï¼Œå­¦ä¹ åœ°å€ï¼ŒAuth-Puess PASSéªŒè¯ï¼Œå¹¶å­¦ä¹ åœ°å€ï¼Œæ‰€æœ‰æ‰§è¡Œé…ç½®æŒ‡å®šçš„å‘½ä»¤ï¼ˆè™½ç„¶å…¶ä¸­ä¸€äº›æ˜¯æœåŠ¡å™¨ç‰¹å®šçš„ï¼‰ã€‚æ”¾ç½®äººå‘˜å¯èƒ½ä¼šå°è¯•æŸ¥çœ‹å’Œç†è§£é…ç½®æ–‡ä»¶ã€‚ä¸è¿‡ï¼Œæˆ‘è®¤ä¸ºä½¿ç”¨åƒé»æ¶²è¿™æ ·çš„å®¢æˆ·ç«¯æ¥è¿‡æ»¤è¿™ç§è¡Œä¸ºæ›´å®‰å…¨ã€‚
Call my a cynic, but one thing I have learned from the using the Internet is to double-check, if not triple-check, everything you download. So many downloads have malware, adware, and scripts that perform malicious activities on your computer that it has to be a requirement to thoroughly check a download before it's used.This point is shown in research posted by Tenable reverse engineer In OpenVPN is a popular open-source VPN program that allows you to create secure and encrypted network connection between your computer or device and another network. Due to its popularity, it has been ported to work on a variety of devices, including routers that run DD-WRT. To facilitate this, VPN providers create OpenVPN profiles that can be downloaded and installed in order to easily configure a VPN connection.According to Baines, to do this all a bad actor would need to do is to add a few lines to a harmless OpenVPN configuration file (.opvpn) to make it malicious. In Baines' example, a OpenVPN configuration file is simply a text file with some commands in it:If an actor wanted to cause the OpenVPN configuration file to execute a command they would add the "When this configuration file is used and after a connection has been established, OpenVPN will execute the above command to open a reverse shell to the computer at 192.168.1.218. This would allow the attacker at that IP address to execute commands on the remote computer that ran the OpenVPN configuration file.Baines even goes on to show how the above method could be ported to attack Windows users by using a PowerShell script instead.While this shows you should be careful about downloading OpenVPN configs from third-parties, Baines told BleepingComputer that he has not found any malicious configs currently in the wild.Now that you know that OpenVPN configuration could be used against you, you may be wondering how to check if any that you use are malicious.In his article, Baines states that you can find clues in a VPN connection log as shown below.If you see the above lines in your log, it means the "script-security 2" setting was used, which allows user defined scripts to be executed. As that line is required to run scripts, it would follow that something is being executed by the configuration file. You should be able to spot the command being executed as shown by the second line in the log above.As OpenVPN configuration files are simply text files, you can also check if an OpenVPN configuration is malicious by opening the file up in Notepad or another text editor. This will allow you to see the entire configuration file and spot if any commands are being executed.Unfortunately, OpenVPN has other configuration directives that can execute commands as well and Baines recommends users use the "Unfortunately, the up command is not the only command that can be used in this way," Baines told BleepingComputer. "Up, down, client-connect, learn-address, auth-user-pass-verify, and learn-address all execute configuration specified commands (although some of these are server specific). A lay person might try to review and understand the configuration file. However, I think its safer to use a client like viscosity that simply filters out this behavior."