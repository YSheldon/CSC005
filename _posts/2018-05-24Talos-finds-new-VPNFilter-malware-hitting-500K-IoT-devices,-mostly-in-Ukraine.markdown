---
layout: post
title: Talos finds new VPNFilter malware hitting 500K IoT devices, mostly in Ukraine
date: 2018-05-24 05:00:24
tourl: https://www.zdnet.com/article/talos-finds-new-vpnfilter-malware-hitting-500k-iot-devices-mostly-in-ukraine/
tags: [attack]
---
VPnMulter恶意软件新的恶意软件称为VPNFLASH，已经在54个国家感染了至少500000个网络设备，主要是消费级互联网路由器。“VPNFLASH恶意软件允许窃取网站凭证和监控Modbus SCADA协议，”研究人员写道。恶意软件具有破坏性的能力，可以使受感染的设备不可用，它可以在个别受害者机器上或集中触发，并有可能切断全球数十万受害者的互联网访问。VPN过滤器的恶意软件与黑能量恶意软件的版本重叠，这是攻击的责任，而研究人员说，这样的要求是不确定的，他们已经观察到VPNFLASE“积极感染”乌克兰主机，利用命令和控制基础设施DE。划到那个国家。研究人员还指出，VPNFilter可能是州资助的或州附属的。正如研究人员所详述的，第1阶段恶意软件通过重新启动持续存在，而通常的恶意软件通常不这样做，第一阶段的主要目的是获得持久的立足点并启用部署O。F阶段2恶意软件。第1阶段利用多个冗余命令和控制（C2）机制来发现当前阶段2部署服务器的IP地址，使得该恶意软件非常健壮并且能够处理不可预测的C2基础设施变化。然而，研究人员说，第2阶段的一些版本还具有自毁能力，它可以重写设备固件的关键部分并重新启动设备，使其失效。E.“基于演员对这些设备的演示知识，以及在某些阶段2版本中的现有能力，我们高度自信地评估，演员可以将该自毁命令部署到其控制的大多数设备上，而不管命令是否被构建到阶段2中。“恶意软件，”报告继续。也有报道说，有多个阶段3模块，作为阶段2恶意软件的插件，提供额外的功能。在发布的时候，TalOS说它知道两个插件模块：一个用于收集通过设备的流量的分组嗅探器，包括窃取网站凭证和监控Modbus SCADA协议；以及允许阶段2通过Tor通信的通信模块。“我们很自信地评估了其他几个插件模块的存在，但是我们还没有发现它们，”研究人员说。网络攻击和恶意软件是互联网上最大的威胁之一。了解不同类型的恶意软件-以及如何避免牺牲品攻击。“我们高度自信地评估，该恶意软件被用来创建一个广阔的，难以定形的基础设施，可以用来服务多个运营需求的威胁演员。”由于受影响的设备是由企业或个人合法拥有的，从受感染设备进行的恶意活动可能被错误地归咎于那些实际上是演员的受害者。“此外，恶意软件也可以用来收集流过影响的数据。研究人员已经说过，VPNFLAST可以被用来通过使用“杀死”命令进行大规模破坏性攻击，这会使部分或全部物理设备无法使用。o安全设备或服务到位，复杂的事实是，大多数受影响的设备已经公开的漏洞，没有补丁的平均用户没有内置的反恶意软件能力，Talos说，保卫VPNFilter是非常困难的。值得关注的是我们。研究人员写道，这表明演员愿意烧掉用户的设备来掩盖他们的踪迹，远比仅仅清除恶意软件的痕迹远。如果它符合他们的目标，这个命令可以在一个大范围内执行，潜在地使成千上万的设备无法使用，禁止全球范围内成千上万的受害者进入互联网，或者在一个适合于演员的目的的焦点区域。“Talos也已经开发出来了。为潜在受影响的设备部署了超过100个Snort签名。研究人员建议小型和家庭办公级路由器和NAS设备的用户将它们重置为工厂默认并重新启动它们，以便删除阶段2和阶段3毫安。Land，和设备制造商联系以确保达到DAT。
VPNFilter malwareA new strain of malware known as VPNFilter has been found infecting at least 500,000 networking devices, mainly consumer-grade internet routers, across 54 countries.According to a "The behaviour of this malware on networking equipment is particularly concerning, as components of the VPNFilter malware allows for theft of website credentials and monitoring of Modbus SCADA protocols," the researchers wrote. "The malware has a destructive capability that can render an infected device unusable, which can be triggered on individual victim machines or en masse, and has the potential of cutting off internet access for hundreds of thousands of victims worldwide."Preliminary findings of the researchers indicate the VPNFilter malware overlaps with versions of the BlackEnergy malware, which was responsible for attacks that While the researchers have said that such a claim isn't definitive, they have observed VPNFilter "actively infecting" Ukrainian hosts, utilising a command and control infrastructure dedicated to that country. The researchers also state VPNFilter is likely state sponsored or state affiliated.As detailed by the researchers, the stage 1 malware persists through a reboot, which normal malware usually does not, with the main purpose of the first stage to gain a persistent foothold and enable the deployment of the stage 2 malware. "Stage 1 utilises multiple redundant command and control (C2) mechanisms to discover the IP address of the current stage 2 deployment server, making this malware extremely robust and capable of dealing with unpredictable C2 infrastructure changes," the researchers wrote.The stage 2 malware possesses capabilities such as file collection, command execution, data exfiltration, and device management; however, the researchers said some versions of stage 2 also possess a self-destruct capability that overwrites a critical portion of the device's firmware and reboots the device, rendering it unusable. "Based on the actor's demonstrated knowledge of these devices, and the existing capability in some stage 2 versions, we assess with high confidence that the actor could deploy this self-destruct command to most devices that it controls, regardless of whether the command is built into the stage 2 malware," the report continues.It has also been reported that there are multiple stage 3 modules that serve as plugins for the stage 2 malware, providing additional functionality. At the time of publication, Talos said it was aware of two plugin modules: A packet sniffer for collecting traffic that passes through the device, including theft of website credentials and monitoring of Modbus SCADA protocols; and a communications module that allows stage 2 to communicate over Tor. "We assess with high confidence that several other plugin modules exist, but we have yet to discover them," the researchers said.Cyber attacks and malware are one of the biggest threats on the internet. Learn about the different types of malware - and how to avoid falling victim to attacks."We assess with high confidence that this malware is used to create an expansive, hard-to-attribute infrastructure that can be used to serve multiple operational needs of the threat actor. "Since the affected devices are legitimately owned by businesses or individuals, malicious activity conducted from infected devices could be mistakenly attributed to those who were actually victims of the actor."Additionally, the malware can also be used to collect data that flows through the affected device.The researchers have said VPNFilter could be used to conduct a large-scale destructive attack by using the "kill" command, which would render some or all of the physical devices unusable.Due to the nature of the affected devices, with the majority connected directly to the internet with no security devices or services in place, compounded by the fact that most of the affected devices already have publicly known vulnerabilities not patched by the average user with no built-in anti-malware capabilities, Talos said defending against VPNFilter is extremely difficult."The destructive capability particularly concerns us. This shows that the actor is willing to burn users' devices to cover up their tracks, going much further than simply removing traces of the malware," the researchers wrote. "If it suited their goals, this command could be executed on a broad scale, potentially rendering hundreds of thousands of devices unusable, disabling internet access for hundreds of thousands of victims worldwide or in a focused region where it suited the actor's purposes."Talos has also developed and deployed more than 100 Snort signatures for the publicly known vulnerabilities for the potentially affected devices.The researchers recommend users of small and home office-grade routers and NAS devices reset them to factory defaults and reboot them in order to remove the stage 2 and stage 3 malware, and reach out to device manufacturers to ensure up-to-date patching. 