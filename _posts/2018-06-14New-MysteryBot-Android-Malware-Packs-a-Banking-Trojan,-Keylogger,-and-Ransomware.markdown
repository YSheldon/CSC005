---
layout: post
title: New MysteryBot Android Malware Packs a Banking Trojan, Keylogger, and Ransomware
date: 2018-06-14 11:50:53
tourl: https://www.bleepingcomputer.com/news/security/new-mysterybot-android-malware-packs-a-banking-trojan-keylogger-and-ransomware/
tags: [WhatsApp]
---
网络罪犯目前正在开发一种针对Android设备的新的恶意软件，它融合了银行木马、键盘记录器和移动勒索软件的特征。命名为MysteryBot的恶意软件毒株仍在开发中，据WestFrand最近的安全研究人员说。ListBuffy说，NothyBoT看起来与著名和高度流行的LokBooT Android银行木马有关。“基于我们对木马的代码的分析，我们相信LokBOT和神秘软件的创造者之间确实存在着一种联系”，这是一种威胁。布料发言人说：“这是有道理的，MysteryBot显然是基于洛基博特的BOT代码，”发言人补充说。此外，根据昨天发布的一份报告，最近的MultyBoT恶意软件将数据发送到同一个命令和控制（CC）服务器。一个过去的LokBoT活动，清楚地表明他们是由同一个人或团体控制和开发的。洛基博特集团现在正在开发NothyBooT的原因是未知的，但它们可能与LokBooT源代码在几个月后网上泄露的事实有关。犯罪集团已经在LokBooT代码上跳了起来，现在也在使用它，而LokBoT人员可能试图想出一个新的恶意软件家族，他们可以在地下论坛上像原来的LokiBot一样进行市场营销。“时刻，可能是因为它仍在开发中，”ThretFabric告诉我们。它也似乎是神秘作家的作者正在从事创造新事物和值得认真付出的工作。TraveFrand说MysteryBot在许多方面与洛基博特相比是独一无二的，但也与其他Android银行恶意软件，如ExoBOT 2.5，ANUBIS II，DeaseBoT，或CyrEclipse。对于初学者来说，NosiyBoT似乎是第一个可以在Android 7和Android 8上显示“覆盖屏幕”的银行恶意软件。银行恶意软件使用这些覆盖屏幕来显示LeGi顶部的假登录页面。最终应用程序。由于谷歌工程师在Android 7和8中添加的安全特性，没有恶意软件能够以一致的方式在这些OS版本上显示覆盖屏幕。问题是，以前的恶意软件在错误的时间显示了覆盖屏幕，因为他们无法检测到用户是V。在屏幕上显示一个应用程序，并且会错误地计算出它应该显示覆盖的时间，通过提示用户在错误的时间登录而放弃它的存在。适当的时间，当用户打开并带来一个应用程序的前景。他们这样做是滥用Android Android PaseGuaseAtStS许可（通常命名为使用访问权限），Android操作系统的特点，显示使用统计的一个应用程序，并间接泄漏的细节，目前使用的应用程序。目前，DeVyYBOT的DEV版本包括定制的“覆盖屏幕”，用于一系列移动电子银行（来自澳大利亚、奥地利、德国、西班牙、法国、克罗地亚、波兰、罗马尼亚）和IM应用，如脸谱网、WhatsApp和ViBER（总共列出了超过100个应用程序的恶意软件目标，以及研究人员预计NoigyBoT将在未来几周支持其屏幕覆盖的阿森纳。此外，恶意软件还配备了一个键盘记录器组件，它与Android市场上的其他键盘记录器相比，也是独一无二的。研究人员说，而不是在屏幕上截屏。用户按下触摸键盘上的一个键来确定用户正在键入什么，MythyBoT反而记录触摸手势的位置。这个新的键盘记录器组件然后试图根据虚拟键盘上的触摸手势的屏幕位置来猜出用户按下了什么键。恶意软件想象用户正在使用。TraveBuffy称这个组件目前还没有工作，因为当前版本对日志数据没有任何作用，例如将其发送到远程服务器。最后但并非最不重要的是，RunSube不加密文件，而是将每一个文件都锁在一个单独的密码保护中。研究人员说，勒索软件模块相当粗糙。对于初学者来说，ZIP存档密码只有八个字符长，这意味着它可以很容易地被放弃。第二，这个密码和用户的自定义生成的受感染设备ID被发送到一个名为MultulyL0CKK的远程控制面板（下面的图像）。问题是分配给EAC的ID。H受害者只能是介于0到9999之间的一个数字，并且当发送到远程控制面板时，没有对预先存在的ID的验证。当同一ID的新受害者与MythyBoT后端同步时，旧的受害者的密码可以很容易地覆盖在控制面板上。迄今为止，它发现的神秘版本已经被伪装成Android的Flash播放器应用程序。
Cybercriminals are currently developing a new strain of malware targeting Android devices which blends the features of a banking trojan, keylogger, and mobile ransomware.Named MysteryBot, this malware strain is still under development, according to security researchers from ThreatFabric, who recently ran across this new threat.ThreatFabric says MysteryBot appears to be related to the well-known and highly popular LokiBot Android banking trojan."Based on our analysis of the code of both Trojans, we believe that there is indeed a link between the creator(s) of LokiBot and MysteryBot," a ThreatFabric spokesperson told "This is justified by the fact that MysteryBot is clearly based on the LokiBot bot code," the spokesperson added.Furthermore, according to a report the company published yesterday, the recent MysteryBot malware sends data to the same command and control (CC) server used in a past LokiBot campaign, clearly suggesting they are being controlled and developed by the same person or group.The reasons why the LokiBot group is now developing MysteryBot are unknown, but they may be related to the fact that the LokiBot source code leaked online a few months back.Several cyber-crime groups have jumped on the LokiBot code and are also using it now, and the LokiBot crew may be trying to come up with a new malware family they can market on underground forums like they did with the original LokiBot."To our knowledge, MysteryBot is not advertised in underground forums at the moment, probably due to the fact that it is still under development," ThretFabric told us.It also appears that the authors of MysteryBot are taking the job of creating something new and worth paying for seriously.ThreatFabric says MysteryBot is unique in many ways compared to LokiBot, but also with other Android banking malware such as ExoBot 2.5, Anubis II, DiseaseBot, or CryEye.For starters, MysteryBot appears to be the first banking malware that can reliably show "overlay screens" on Android 7 and Android 8.Banking malware uses these overlay screens to show fake login pages on top of legitimate apps. Due to the security features Google engineers added in Android 7 and 8, no malware was able to show overlay screens on these OS versions in a consistent manner.The problem was that previous malware strains showed the overlay screens at the wrong time because they couldn't detect when the user was viewing an app on his screen and would miscalculate the time when it should show the overlay, giving away its presence by prompting the user to log in at the wrong time.According to ThreatFabric, the MysteryBot team appears to have found a reliable way to time its overlay screens at show them at the proper time when the user opens and brings an app into the foreground.They did this by abusing the Android PACKAGE_USAGE_STATS permission (commonly named Usage Access permission), an Android OS feature that shows usage stats about an app, and indirectly leaks details about the currently used app.The current, in-dev version of MysteryBot includes custom-made "overlay screens" for a slew of mobile e-banking (from Australia, Austria, Germany, Spain, France, Croatia, Poland, Romania) and IM apps such as Facebook, WhatsApp and Viber (listed in full The malware targets over 100 apps in total, and researchers expect MysteryBot to bolster its screen overlay arsenal in the coming weeks.Furthermore, the malware also comes with a keylogger component, which is also unique when compared to other keyloggers found on the Android market.Researchers say that instead of taking screenshots at the moment the user presses a key on the touch-based keyboard to determine what the user is typing, MysteryBot records the location of a touch gesture instead.This new keylogger component then tries to guess what key the user has pressed based on the touch gesture's screen position on a virtual keyboard the malware imagines the user is using.ThreatFabric says this component isn't working just yet, as current versions don't do anything with the logged data, such as sending it to a remote server.Last but not least, The ransomware doesn't encrypt files but locks each one in an individual password-protected ZIP archive.Researchers say the ransomware module is quite shoddy coded. For starters, the ZIP archive password is only eight characters long, meaning it could be very easily brute-forced.Second, this password and the user's custom-generated infected device ID are sent to a remote control panel named Myster_L0cker (image below).The problem is that the ID assigned to each victim can be a number between 0 and 9999 only, and there's no verification of pre-existing IDs when sent to the remote control panel.Passwords for older victims can be easily overwritten on the control panel when a new victim with the same ID syncs to the MysteryBot backend.ThreatFabric says the current versions of MysteryBot it spotted until now have been disguised as a Flash Player app for Android."In general, the consumer must be aware that all of the so called 'Flash Player (update) apps' that can be found in and outside the various app stores are malware," ThreatFabric told "Many web sites still require visitors to have support for Flash (which has not been available on Android for many years) causing Android users to try and find an app that will let them use that web site," the spokesperson added. "In the end they will just end up installing malware."While MysteryBot is currently not in circulation, ThreatFabric told us that LokiBot was previously spread via SMS spam (smishing) and emails (phising) containing links to an Android app. Users were supposed to side-load this malicious app and then grant the app access to the Android Accessibility service before the malware could do any damage. It is safe to say that MysteryBot may be distributed in the same way, based on the existing connections to the LokiBot crew.Experts recommend that users avoid side-loading (installing) apps from outside the Play Store, and avoid granting apps access to the Accessibility service, which in the vast majority of cases is used mostly by malware.In its current form, MysteryBot still needs access to the Accessibility service, which it uses for its keylogger and ransomware components.The malware also uses access to the Accessibility service to grant itself permission to access the PACKAGE_USAGE_STATS feature without prompting the user. This means that users may still be able to spot MysteryBot before getting infected when they're prompted to allow an app access to the highly-privileged Accessibility service.Furthermore, users should also pay attention to what they're downloading from the Play Store as well."There are still many droppers on the Google Play Store as it seems to be an efficient mean of distribution," ThreatFabric said. "However, most Android banking Trojans seem to be distributed via smishing/phishingside-loading."You may not be getting a banking trojan, but you're getting malware nevertheless.9 more apps with 130K+ installs based on Play Store 