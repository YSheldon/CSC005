---
layout: post
title: New Telegram-abusing Android RAT discovered in the wild
date: 2018-06-18 17:01:52
tourl: https://www.welivesecurity.com/2018/06/18/new-telegram-abusing-android-rat/
tags: [Telegram]
---
ç”±ESETç ”ç©¶è€…å‘ç°çš„å…¨æ–°çš„æ¶æ„è½¯ä»¶å®¶æ—å·²ç»å‘ç°äº†ä¸€ä¸ªæ–°çš„Androidå¤§é¼ å®¶æ—ï¼ˆè¿œç¨‹ç®¡ç†å·¥å…·ï¼‰ï¼Œå®ƒå·²ç»æ»¥ç”¨äº†ç”¨äºå‘½ä»¤å’Œæ§åˆ¶çš„ç”µæŠ¥åè®®å’Œæ•°æ®è¿‡æ»¤ã€‚å…ˆå‰æŠ¥å‘Šçš„ä¸€ä¸ªå˜ä½“ä¸­çš„ä¸€éƒ¨åˆ†çš„æŠ˜è¡·æ´»åŠ¨ä¸å…¶ä½™çš„ä¸åŒï¼Œå°½ç®¡æœ‰å…è´¹çš„æºä»£ç ï¼Œå®ƒè¢«æä¾›åœ¨ä¸€ä¸ªä¸“ç”¨çš„ç”µæŠ¥ä¿¡é“ä¸Šå‡ºå”®ï¼Œåœ¨HeloATçš„åç§°ä¸‹é”€å”®ã€‚å®ƒå¯ä»¥åœ¨ä¸‰ä¸ªå®šä»·æ¨¡å‹æ ¹æ®åŠŸèƒ½ï¼Œå¹¶é™„å¸¦ä¸€ä¸ªæ”¯æŒè§†é¢‘é€šé“ã€‚ç›®å‰è¿˜ä¸æ¸…æ¥šè¿™ä¸€å˜ä½“æ˜¯æºäºæ³„éœ²çš„æºä»£ç ï¼Œè¿˜æ˜¯æºä»£ç æ³„éœ²çš„åŸå§‹ç‰ˆæœ¬ã€‚æ”»å‡»è€…é€šè¿‡ç¬¬ä¸‰æ–¹åº”ç”¨å•†åº—ã€ç¤¾äº¤åª’ä½“å’Œæ¶ˆæ¯åº”ç”¨ç¨‹åºè¯±ä½¿å—å®³è€…é€šè¿‡å„ç§å¸å¼•äººçš„å£°éŸ³ä¼ªè£…æ¥ä¸‹è½½è€é¼ ã€‚æˆ‘ä»¬çœ‹åˆ°çš„æ¶æ„è½¯ä»¶ä¸»è¦åˆ†å¸ƒåœ¨ä¼Šæœ—ï¼Œå› ä¸ºåº”ç”¨ç¨‹åºæ‰¿è¯ºå…è´¹æ¯”ç‰¹å¸ï¼Œå…è´¹çš„äº’è”ç½‘è¿æ¥ï¼Œä»¥åŠé¢å¤–çš„è¿½éšè€…åœ¨ç¤¾äº¤åª’ä½“ä¸Šã€‚æ¶æ„è½¯ä»¶æ²¡æœ‰åœ¨è°·æ­Œæ’­æ”¾ä¸­çœ‹åˆ°ã€‚å›¾1æ˜¯ç”¨äºä¼ æ’­RATHIDæ¶æ„è½¯ä»¶çš„ä¸€äº›ä¼ªè£…ï¼Œåœ¨æ‰€æœ‰Androidç‰ˆæœ¬ä¸Šè¿è¡Œï¼šä½†æ˜¯ï¼Œå—å½±å“çš„ç”¨æˆ·éœ€è¦æ¥å—åº”ç”¨ç¨‹åºæ‰€éœ€çš„æƒé™ï¼ˆæœ‰æ—¶åŒ…æ‹¬æ¿€æ´»ä½œä¸ºè®¾å¤‡ç®¡ç†å‘˜çš„åº”ç”¨ç¨‹åºï¼‰ï¼Œè¿™æ˜¯SOCIçš„æ‰€åœ¨ã€‚å›¾2ã€‚é¼ è¯·æ±‚è®¾å¤‡ç®¡ç†å‘˜æƒé™åœ¨æ¶æ„è½¯ä»¶å®‰è£…å¹¶åœ¨å—å®³è€…è®¾å¤‡ä¸Šå¯åŠ¨åï¼Œå‡ºç°ä¸€ä¸ªå°å¼¹å‡ºï¼Œå£°ç§°åº”ç”¨ç¨‹åºä¸èƒ½è¿è¡Œåœ¨è®¾å¤‡ä¸Šï¼Œå› æ­¤å°†è¢«å¸è½½ã€‚åœ¨æˆ‘ä»¬åˆ†æçš„å˜ä½“ä¸­ï¼Œå‡å¸è½½æ¶ˆæ¯å¯ä»¥ç”¨è‹±è¯­æˆ–æ³¢æ–¯è¯­æ¥æ˜¾ç¤ºï¼Œè¿™å–å†³äºç›®æ ‡è®¾å¤‡çš„è¯­è¨€è®¾ç½®ã€‚åœ¨å¸è½½å®Œæˆåï¼ŒAPPçš„å›¾æ ‡æ¶ˆå¤±ã€‚ç„¶è€Œï¼Œåœ¨æ”»å‡»è€…çš„æ—è¾¹ï¼Œä¸€ä¸ªæ–°çš„è¢«å®³è®¾å¤‡åˆšåˆšæ³¨å†Œã€‚å›¾3çš„HelORATä½œè€…æ¼”ç¤ºäº†åœ¨è‡ªå·±çš„è®¾å¤‡ä¸Šå®‰è£…RATï¼ˆç”±æ¶æ„è½¯ä»¶ä½œè€…æä¾›çš„ä¸€ä¸ªæ•™å­¦è§†é¢‘æˆªå›¾ï¼‰å›¾4æ¶æ„è½¯ä»¶æºä»£ç ä¼ªé€ å¸è½½æˆ‘ã€‚åœ¨è‹±å›½å’Œæ³¢æ–¯å°¼äºšçš„SyGeséƒ½å¯ä»¥è®¿é—®å—å®³è€…çš„è®¾å¤‡ï¼Œæ”»å‡»è€…åˆ©ç”¨æ¶æ„è½¯ä»¶å…·æœ‰å¹¿æ³›çš„é—´è°å’Œæ–‡ä»¶è¿‡æ»¤èƒ½åŠ›ï¼ŒåŒ…æ‹¬æ‹¦æˆªæ–‡æœ¬æ¶ˆæ¯å’Œè”ç³»äººï¼Œå‘é€æ–‡æœ¬æ¶ˆæ¯å’Œæ‹¨æ‰“ç”µè¯ã€éŸ³é¢‘å’Œå±å¹•è®°å½•ã€‚Gï¼Œè·å¾—è®¾å¤‡ä½ç½®ï¼Œå¹¶æ§åˆ¶è®¾å¤‡çš„è®¾ç½®ã€‚HeRoATçš„åŠŸèƒ½åˆ†ä¸ºä¸‰ä¸ªæ†ï¼Œå³é’é“œã€é“¶å’Œé‡‘é¢æ¿ï¼Œåˆ†åˆ«å‡ºå”®25, 50å’Œ100ç¾å…ƒã€‚æºä»£ç æœ¬èº«ç”±HeloRAT'Sï¼ˆé›„å¿ƒå‹ƒå‹ƒï¼‰ä½œè€…æä¾›650ç¾å…ƒã€‚æ¶æ„è½¯ä»¶çš„èƒ½åŠ›å¯ä»¥åœ¨ç”µæŠ¥BOTæ¥å£ä¸­ä»¥å¯ç‚¹å‡»æŒ‰é’®çš„å½¢å¼è®¿é—®ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ç®€å•åœ°çªƒå–åœ¨å…¶æ“ä½œçš„æ¶æ„è½¯ä»¶ç‰ˆæœ¬ä¸­å¯ç”¨çš„æŒ‰é’®æ¥æ§åˆ¶å—å®³è®¾å¤‡ã€‚å›¾5ï¼šHelORATæ§åˆ¶é¢æ¿6çš„HeloATåŠŸèƒ½ä»å·¦åˆ°å³ï¼Œé’é“œé¢æ¿ï¼Œé“¶é¢æ¿å’Œé‡‘é¢æ¿ï¼ˆä»ä¸€ä¸ªå±å¹•æˆªå›¾ï¼‰æ¶æ„è½¯ä»¶ä½œè€…æä¾›çš„è§†é¢‘è§†é¢‘ä¸åŒäºå…ˆå‰åˆ†æçš„å®‰å“è€é¼ çš„ç”µæŠ¥ï¼Œå®ƒæ˜¯ç”¨æ ‡å‡†çš„Android Javaç¼–å†™çš„ï¼Œè¿™ä¸ªæ–°å‘ç°çš„æ¶æ„è½¯ä»¶å®¶æ—æ˜¯é€šè¿‡æ¶æ„è½¯ä»¶é€šè¿‡ç”µæŠ¥åè®®HAé€šä¿¡çš„æ–¹å¼ä»å¤´å¼€å§‹å¼€å‘çš„ã€‚Sè¢«æ”¹ç¼–æˆå®ƒçš„ç¼–ç¨‹è¯­è¨€ï¼Œè€Œä¸æ˜¯ä»å—å®³è®¾å¤‡çš„é€šä¿¡å‘½ä»¤åˆ°å’Œé€€å‡ºæ•°æ®éƒ½å®Œå…¨é€šè¿‡ç”µæŠ¥åè®®æ¥è¦†ç›–ï¼Œè¯¥åè®®æ—¨åœ¨é¿å…åŸºäºå·²çŸ¥çš„ä¸Šä¼ æœåŠ¡å™¨çš„æµé‡çš„æ£€æµ‹ã€‚æœ€è¿‘å…è´¹å¼€å‘çš„ä»£ç ï¼Œå¯ä»¥åœ¨ä¸–ç•Œä»»ä½•åœ°æ–¹å¼€å‘å’Œéƒ¨ç½²æ–°çš„çªå˜ã€‚ç”±äºè¿™ç§æ¶æ„è½¯ä»¶çš„ä¼ªè£…æ–¹æ³•å’Œå½¢å¼ä¸åŒï¼Œæ£€æŸ¥æ‚¨çš„è®¾å¤‡æ˜¯å¦å­˜åœ¨ä»»ä½•ç‰¹å®šçš„åº”ç”¨ç¨‹åºä¸è¶³ä»¥è¯´æ˜æ‚¨çš„è®¾å¤‡æ˜¯å¦å·²è¢«ç ´åã€‚å¦‚æœæ‚¨æœ‰ç†ç”±ç›¸ä¿¡æ‚¨çš„è®¾å¤‡å·²è¢«è¯¥æ¶æ„è½¯ä»¶æŸåï¼Œè¯·æ‰«æIã€‚ä½¿ç”¨å¯é çš„ç§»åŠ¨å®‰å…¨è§£å†³æ–¹æ¡ˆã€‚ESETç³»ç»Ÿæ£€æµ‹å’Œé˜»æ­¢è¿™ä¸€å¨èƒï¼Œå¦‚Android / SPAG.At.AMSå’ŒAndroid / AgTun.AQOï¼Œä»¥é¿å…Androidæ¶æ„è½¯ä»¶çš„ç‰ºç‰²å“ï¼Œåœ¨ä¸‹è½½åº”ç”¨ç¨‹åºæ—¶åšæŒè°·æ­Œå®˜æ–¹æ¸¸æˆå•†åº—ï¼Œåœ¨ä¸‹è½½ä»»ä½•ä¸œè¥¿åˆ°ä½ çš„è®¾å¤‡ä¹‹å‰ä¸€å®šè¦é˜…è¯»ç”¨æˆ·è¯„è®ºå¹¶æ³¨æ„ä»€ä¹ˆã€‚åœ¨å®‰è£…å‰å’Œå®‰è£…åï¼Œä½ éƒ½åŒæ„åº”ç”¨ç¨‹åºçš„ä»»åŠ¡ã€‚
Entirely new malware family discovered by ESET researcherstttttttttttttttESET researchers have discovered a new family of Android RATs (Remote Administration Tools), that has been abusing the Telegram protocol for command and control, and data exfiltration.Investigating what at first seemed like increased activity on the part of the previously reported One of these variants is different from the rest – despite the freely available source code, it is offered for sale on a dedicated Telegram channel, marketed under the name HeroRat. It is available in three pricing models according to functionality, and comes with a support video channel. It is unclear whether this variant was created from the leaked source code, or if it is the “original” whose source code was leaked.Attackers lure victims into downloading the RAT by spreading it under various attractive-sounding guises, via third-party app stores, social media and messaging apps. We’ve seen the malware distributed mostly in Iran, as apps promising free bitcoins, free internet connections, and additional followers on social media. The malware has not been seen on Google Play.Figure 1 – Some of the guises used to propagate the RATThe malware runs on all Android versions: however, affected users need to accept permissions required by the app (sometimes including activating the app as device administrator), which is where social engineering comes into play.Figure 2 – The RAT requesting device administrator rightsAfter the malware is installed and launched on the victim’s device, a small popup appears, claiming the app can’t run on the device and will therefore be uninstalled. In the variants we analyzed, the fake uninstall message can be displayed in English or Persian, depending on the target device‘s language settings.After the uninstallation is seemingly completed, the app’s icon disappears. On the attacker’s side, however, a new victimized device has just been registered.Figure 3 – HeroRat author’s demonstration of installing the RAT on his own device (screenshots from an instructional video provided by the malware author)Figure 4 – Malware source code with fake uninstallation messages in both English and PersianHaving gained access to the victim’s device, the attacker then leverages The malware has a wide array of spying and file exfiltration capabilities, including intercepting text messages and contacts, sending text messages and making calls, audio and screen recording, obtaining device location, and controlling the device’s settings.HeroRat’s functionality is divided into three “bundles” – bronze, silver and gold panels – offered for sale for 25, 50, and 100 USD, respectively. The source code itself is offered for 650 USD by HeroRat’s (ambitious) author.The malware’s capabilities are accessible in the form of clickable buttons in the Telegram bot interface. Attackers can control victimized devices by simply tapping the buttons available in the version of the malware they are operating.Figure 5 – HeroRat control panelFigure 6 – HeroRat functionality – from left to right, “Bronze panel”, “Silver panel” and “Gold panel” (screenshots from an instructional video provided by the malware author)Unlike the Telegram-abusing Android RATs previously analyzed, which are written in standard Android Java, this newly-discovered malware family has been developed from scratch in C# using the The way the malware communicates via the Telegram protocol has been adapted to its programming language – instead of the Communicating commands to and exfiltrating data from the compromised devices are both covered entirely via the Telegram protocol – a measure aimed at avoiding detection based on traffic to known upload servers.With the malware’s source code recently made available for free, new mutations could be developed and deployed anywhere in the world. Since the distribution method and form of disguise of this malware varies case by case, checking your device for the presence of any specific applications is not enough to tell if your device has been compromised.If you have reason to believe your device has been compromised by this malware, scan it using a reliable mobile security solution. ESET systems detect and block this threat as Android/Spy.Agent.AMS and Android/Agent.AQO.To avoid falling victim to Android malware, stick to the official Google Play store when downloading apps, make sure to read user reviews before downloading anything to your device and pay attention to what permissions you grant to apps both before and after installation.