---
layout: post
title: Google, Roku, Sonos to Fix DNS Rebinding Attack Vector
date: 2018-06-20 12:20:56
tourl: https://www.bleepingcomputer.com/news/security/google-roku-sonos-to-fix-dns-rebinding-attack-vector/
tags: [DNS,attack,bill]
---
è°·æ­Œå®¶åº­ã€RKU TVå’ŒSONOSçš„å¼€å‘å›¢é˜Ÿæ­£åœ¨å‡†å¤‡å®‰å…¨è¡¥ä¸ï¼Œä»¥é˜²æ­¢DNSé‡æ–°ç»‘å®šæ”»å‡»ä»–ä»¬çš„è®¾å¤‡ã€‚RoKuå·²ç»å¼€å§‹éƒ¨ç½²æ›´æ–°ï¼Œè€Œè°·æ­Œå’ŒSoNOSé¢„è®¡ä¸‹ä¸ªæœˆéƒ¨ç½²è¡¥ä¸ã€‚DNSé‡æ–°ç»‘å®šä¸æ˜¯ä»»ä½•STRçš„æ–°æ”»å‡»å‘é‡ã€‚æƒ³è±¡çš„åˆ»èš€ç ”ç©¶äººå‘˜ä»2007å¼€å§‹å°±çŸ¥é“è¿™ä¸€ç‚¹ï¼Œå®ƒé¦–å…ˆåœ¨DNSé‡æ–°ç»‘å®šæ”»å‡»çš„ç›®çš„æ˜¯ä½¿è®¾å¤‡ç»‘å®šåˆ°æ¶æ„DNSæœåŠ¡å™¨ï¼Œç„¶åä½¿è®¾å¤‡è®¿é—®éé¢„æœŸåŸŸã€‚DNSé‡æ–°ç»‘å®šæ”»å‡»é€šå¸¸ç”¨äºå¦¥åè®¾å¤‡ï¼Œå¹¶å°†å®ƒä»¬ç”¨ä½œå†…éƒ¨ç½‘ç»œä¸­çš„ä¸­ç»§ç‚¹ã€‚å…¸å‹çš„DNSé‡æ–°ç»‘å®šæ”»å‡»é€šå¸¸ç»å†ä»¥ä¸‹é˜¶æ®µï¼šåœ¨å‡ ä¹æ‰€æœ‰æƒ…å†µä¸‹ï¼ŒDNSé‡æ–°ç»‘å®šæ”»å‡»ä¸è¢«ç”¨äºå°†ç”¨æˆ·é‡å®šå‘åˆ°æ¶æ„çš„å¤–éƒ¨IPsï¼Œè€Œæ˜¯ç”¨äºæœ¬åœ°ç½‘ç»œä¸Šçš„IPSã€‚DNSé‡æ–°ç»‘å®šæ”»å‡»ä¸ä¸å…·æœ‰å®‰å…¨PRçš„è®¾å¤‡è€¦åˆæ—¶æ˜¯å±é™©çš„ã€‚å¯¹æ¥è‡ªå†…éƒ¨ç½‘ç»œçš„è¯·æ±‚è¿›è¡Œå¤„ç†ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªAPIç«¯ç‚¹æˆ–ä¸€ä¸ªç®¡ç†é¢æ¿ï¼Œå½“å®ƒå¯¹WANè¯·æ±‚æœ‰å®‰å…¨æ€§æ—¶ï¼Œä¸éœ€è¦ä»LANè¯·æ±‚ä¸­è¿›è¡Œè®¤è¯ã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯ä»¥æ¬ºéª—ç”¨æˆ·è®¿é—®æ¶æ„çš„SITIE.comï¼Œç„¶åä½¿ç”¨æ¶æ„DNSæœåŠ¡å™¨ä¸ºæ¶æ„ç½‘ç«™-SITE COMè¿›è¡Œç”¨æˆ·æµè§ˆã€‚Rä»¥â€œHTTP://192.1680.1/RouTe/Enabel/WANâ€çš„å½¢å¼è®¿é—®URLï¼Œå¹¶è‡ªåŠ¨é…ç½®æœ¬åœ°è·¯ç”±å™¨ï¼Œå°†å…¶ç®¡ç†é¢æ¿æ‰“å¼€åˆ°å¤–éƒ¨è¿æ¥ã€‚ä½†å°½ç®¡å·²æœ‰åå¤šå¹´çš„å†å²ï¼ŒDNSé‡æ–°ç»‘å®šåœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯åœ¨é›·è¾¾ä¸‹è¿›è¡Œçš„ï¼Œå› ä¸ºä¾›åº”å•†ä¸ç›¸ä¿¡THRã€‚åƒç”·æ¼”å‘˜ä¼šè´¹å¿ƒå°è¯•è¿™æ ·çš„é»‘å®¢ã€‚åŸå› æ˜¯åˆ©ç”¨DNSé‡æ–°ç»‘å®šç¼ºé™·éœ€è¦ä¸€ä¸ªå¤šæ­¥éª¤çš„è¿‡ç¨‹ï¼Œå¤§é‡çš„è‡ªå®šä¹‰å·¥å…·ï¼Œä»¥åŠæ”»å‡»è€…çš„å¾ˆå¤šè€å¿ƒã€‚å› ä¸ºåœ¨è¿™ç§æ”»å‡»ä¸­æ¶‰åŠåˆ°è®¸å¤šç§»åŠ¨éƒ¨åˆ†ï¼Œä»¥åŠè®¸å¤šå‡ºé”™çš„å¯èƒ½æ€§ã€‚ä¾›åº”å•†è®¤ä¸ºé»‘å®¢ä¸ä¼šå¯¹è¿™ç§é»‘å®¢æ„Ÿå…´è¶£ã€‚å› æ­¤ï¼Œç°åœ¨å¾ˆå°‘æœ‰äº§å“èƒ½ä¸DNSé‡æ–°ç»‘å®šï¼Œä½†æ˜¯è¿‘å‡ ä¸ªæœˆæ¥ï¼Œæƒ…å†µå·²ç»å¼€å§‹æ”¹å˜ã€‚å¯¹DNSé‡æ–°ç»‘å®šæ¼æ´çš„å…´è¶£æ¥è‡ªè‘—åçš„å®‰å…¨ç ”ç©¶äººå‘˜ï¼Œå¦‚è°·æ­Œçš„Tavis Ormandyï¼Œé‡æ–°æŠŠè¿™ä¸ªé—®é¢˜å¸¦å…¥äº†èšå…‰ç¯ã€‚æ¼æ´å·²ç»è¢«å‘ç°å¹¶è¢«å›ºå®šåœ¨äº§å“ä¸­ï¼Œæ¯”å¦‚DNSé‡æ–°ç»‘å®šæ”»å‡»çš„æœ€æ–°æ·±åº¦ä¹‹ä¸€æ¥è‡ªèŠåŠ å“¥çš„Bronå¤šå°”è¥¿ã€‚æ˜¨å¤©ï¼Œä»–å‘è¡¨äº†ä»–å¯¹è¿™ä»¶äº‹çš„æœ€æ–°ç ”ç©¶ï¼Œå…¶ä¸­åŒ…æ‹¬å¯¹ä¸€äº›ç°ä»£ç‰©è”ç½‘è®¾å¤‡çš„ç ”ç©¶ï¼Œä»¥åŠä»–ä»¬å¦‚ä½•å¤„ç†DNSé‡æ–°ç»‘å®šæ”»å‡»ã€‚æ²¡æœ‰äººæƒŠè®¶çš„æ˜¯ï¼Œå¤šå°”è¥¿å‘ç°ä»–æµ‹è¯•çš„å¤§éƒ¨åˆ†è®¾å¤‡éƒ½æ˜¯è„†å¼±çš„ã€‚åœ¨è¿‡å»çš„ä¸‰ä¸ªæœˆé‡Œï¼Œä»–ä¸€ç›´å›°æ‰°ç€ä¾›åº”å•†ä¿®è¡¥è¿™äº›é—®é¢˜ï¼Œç›´åˆ°ä¸¤åæ–°é—»å·¥ä½œè€…å‚ä¸è¿›æ¥ï¼Œå¹¶å¼€å§‹å°±è¿™ä¸ªé—®é¢˜å¼€å§‹æé—®ã€‚æ›´ä¸‹é¢çš„å†…å®¹ï¼šå¤šå°”è¥¿å‘ç°ï¼Œé€šè¿‡ä½¿ç”¨ä¸€ä¸ªDNSé‡æ–°ç»‘å®šæ”»å‡»å°†æ¶æ„åŸŸç»‘å®šåˆ°åœ¨ç«¯å£8008ä¸Šçš„è°·æ­Œå®¶ç”¨è®¾å¤‡ä¸Šè¿è¡Œçš„æœªè®°å½•çš„REST APIï¼Œä»–å¯ä»¥è®¿é—®ä¸€ç³»åˆ—å‘½ä»¤ï¼Œä¾‹å¦‚å¯åŠ¨åº”ç”¨ç¨‹åºã€æ’­æ”¾å†…å®¹ã€æ‰«æå’ŒåŠ å…¥é™„è¿‘çš„WiFiç½‘ç»œã€ReBoç­‰ã€‚æ­¤å¤–ï¼Œå¤šå°”è¥¿è®¤ä¸ºï¼Œé€šè¿‡æ”¶é›†æ¥è‡ªå—å®³è€…çš„WiFiæ¥å…¥ç‚¹çš„ä¿¡æ¯ï¼Œæ”»å‡»è€…è¿˜å¯ä»¥åŸºäºå°†WiFiç½‘ç»œSSIDä¸çœŸå®ä¸–ç•Œä½ç½®é“¾æ¥çš„å…¬å…±å¯è®¿é—®æ•°æ®åº“åå‘è®¾è®¡ç”¨æˆ·çš„åœ°ç†ä½ç½®ã€‚ç ”ç©¶äººå‘˜è¿˜æŠ¥é“äº†ChrimeCasterè®¾å¤‡å­˜åœ¨çš„é—®é¢˜ï¼Œç ”ç©¶äººå‘˜å‘è°·æ­ŒæŠ¥å‘Šäº†DNSé‡æ–°ç»‘å®šæ”»å‡»å‘é‡ï¼Œä½†è¯¥å…¬å¸åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå¿½ç•¥äº†ä»–çš„æœ€åˆæŠ¥å‘Šã€‚è°·æ­Œä¸»é˜Ÿåœ¨å‡ ä¸ªæœˆåæ”¹å˜äº†ä¸»æ„ï¼Œåœ¨ä¸€ä¸ªç»Šç½‘å®‰å…¨ç ”ç©¶äººå‘˜åœ¨åŒä¸€DNSé‡æ–°ç»‘å®šåã€‚åœ¨RoKuè®¾å¤‡ä¸Šä¹Ÿå‘ç°äº†ç²˜æ€§çŸ¢é‡ï¼ˆCVE-2018- 11314ï¼‰ã€‚ç ”ç©¶äººå‘˜è¯´ï¼ŒRoKuè®¾å¤‡åœ¨ç«¯å£8060ä¸Šå…¬å¼€äº†ä¸€ä¸ªAPIæœåŠ¡å™¨ï¼Œå¯ä»¥ä»ç”¨æˆ·çš„å†…éƒ¨ç½‘ç»œè®¿é—®ã€‚æ”»å‡»è€…å¯ä»¥ä½¿ç”¨DNSé‡æ–°ç»‘å®šæ”»å‡»å‘è¯¥APIæœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œå¹¶æ§åˆ¶åŸºæœ¬è®¾å¤‡åŠŸèƒ½ï¼Œä¾‹å¦‚å¯åŠ¨åº”ç”¨ç¨‹åºã€æœç´¢ã€æ’­æ”¾å†…å®¹ï¼Œç”šè‡³æ˜¯æ¨¡æ‹Ÿç¨‹åºã€‚è¾“å…¥é”®ä½¿ç”¨è™šæ‹Ÿé”®ç›˜åº”ç”¨ç¨‹åºã€‚RoKuæœ€åˆæ‹’ç»æ‰¿è®¤DNSé‡æ–°ç»‘å®šä½œä¸ºä¸€ä¸ªå¯è¡Œçš„æ”»å‡»å‘é‡å’Œä»–ä»¬çš„è®¾å¤‡çš„å®‰å…¨é£é™©ã€‚è¯¥å…¬å¸æ”¹å˜ä¸»æ„åï¼Œå¤šå°”è¥¿å…¬å¸é¢„è®¡è¡¥ä¸å°†åœ¨ä¸‰è‡³å››ä¸ªæœˆå†…å…¬å¸ƒï¼Œä½†åŠ å¿«ä»–ä»¬çš„å·¥ä½œæ—¶ï¼Œå¤šå°”è¥¿å‘Šè¯‰ä»–ä»¬ï¼Œä»–æ‰“ç®—å‡ºç‰ˆå¤šå°”è¥¿è¿˜å‘ç°ï¼ŒSONOS WiFiæ‰¬å£°å™¨ä¹Ÿæ˜“å—DNSé‡æ–°ç»‘å®šæ”»å‡»ï¼ˆCVE-2018ï¼‰11316ï¼‰ã€‚åœ¨è¿™äº›è®¾å¤‡ä¸Šï¼Œå¤šå°”è¥¿è¯´æ”»å‡»è€…å¯ä»¥å°†å¤–éƒ¨åŸŸé‡æ–°ç»‘å®šåˆ°ç«¯å£1400ä¸Šçš„å†…éƒ¨UPnPç«¯ç‚¹ï¼Œè¯¥ç«¯å£å¯ä»¥ç”¨ä½œåœ¨è®¾å¤‡ä¸Šè¿è¡ŒUNIXå¤–å£³å‘½ä»¤çš„ä¸­ä»‹ã€‚ç ”ç©¶äººå‘˜è¯´ï¼Œè¿™äº›å‘½ä»¤å…è®¸æ”»å‡»è€…ä½¿ç”¨â€œæ˜ å°„â€æ¥æ˜ å°„å†…éƒ¨å’Œå¤–éƒ¨ç½‘ç»œã€‚TraceouTEå‘½ä»¤å’Œæ¢æµ‹ä¸»æœºä½¿ç”¨ICPè¯·æ±‚ï¼Œä½¿ç”¨ç®€å•çš„POSTè¯·æ±‚è¿›è¡Œpingã€‚â€œæ”»å‡»è€…å¯ä»¥ä½¿ç”¨SONOSè®¾å¤‡ã€‚
The developer teams from Google Home, Roku TV, and Sonos, are preparing security patches to prevent DNS rebinding attacks on their devices.Roku has already started deploying updates, while Google and Sonos are expected to deploy patches next month.DNS rebinding is not a new attack vector by any stretch of the imagination. Researchers have known about it since 2007 when it was first detailed in a The purpose of a DNS rebinding attack is to make a device bind to a malicious DNS server and then make the device access unintended domains. DNS rebinding attacks are usually used to compromise devices and use them as relay points inside an internal network. A typical DNS rebinding attack usually goes through the following stages:In almost all cases, DNS rebinding attacks aren't used to redirect users to malicious external IPs, but for IPs on the local network.DNS rebinding attacks are dangerous when coupled with devices that do not feature security protections for requests made from the internal network. For example, an API endpoint or an admin panel that while secure against WAN requests, is left without authentication from LAN requests.For example, an attacker can trick a user into accessing malicious-site.com, and then use the malicious DNS server for malicious-site.com to make the user's browser access an URL in the form of "http://192.168.0.1/router/enable/WAN" and automatically configure the local router into opening its admin panel to external connections.But despite being known for more than a decade, DNS rebinding has largely gone under the radar because vendors didn't believe a threat actor would bother attempting such hacks.The reasons are that exploiting DNS rebinding flaws requires a multi-step process, lots of custom tools, and a lot of patience from attackers.Because of the many moving parts involved in such an attack, and the many possibilities of something going wrong, vendors believed hackers wouldn't have any interest in carrying out such hacks. Hence, very few products nowadays are hardened against DNS rebinding.However, in recent months, things have started to change. Interest into DNS rebinding flaws from well-known security researchers like Google's Tavis Ormandy has re-brought this issue into the limelight.Flaws have been discovered and fixed in products such as One of the latest deep-dives into DNS rebinding attacks comes from Chicago-based Brannon Dorsey. Yesterday, he published his latest research on the matter, which included a study of some modern IoT equipment and how they handle a DNS rebinding attack.To nobody's surprise, Dorsey found that most of the equipment he tested was vulnerable. For the past three months, he's badgered vendors to patch these issues and found no success until two members of the press got involved and also started asking questions on the topic. More below:Dorsey found that by using a DNS rebinding attack that binds a malicious domain to an undocumented REST API that runs on Google Home devices on port 8008, he could have access to a slew of commands such as the ability to launch apps, play content, scan and join nearby WiFi networks, reboot, and even factory reset the device.Furthermore, Dorsey argued that by collecting info on WiFi access points from victims, an attacker could also reverse engineer a user's geographical location based on publicly accessible databases that linked WiFi network SSIDs with real-world locations.Similar issues were also present on Chromecast devices, Dorsey said.The researcher reported the DNS rebinding attack vector to Google, but the company largely ignored his initial reports.The Google Home team changed its mind a few months later after a Tripwire security researcher The same DNS rebinding attack vector is also found on Roku devices (CVE-2018–11314). The researcher says that Roku devices expose an API server on port 8060, accessible from a user's internal network.An attacker could use a DNS rebinding attack to send requests to this API server and control basic device functions such as launching apps, searching, playing content, and even simulating keys input using a virtual keyboard app.Roku initially refused to acknowledge DNS rebinding as a feasible attack vector and a security risk for their devices. The company changed its mind after Dorsey The company anticipated that a patch would be released in three to four months, but expedited their work when Dorsey told them he was planning to publish Dorsey also discovered that Sonos WiFi speakers were also vulnerable to DNS rebinding attacks (CVE-2018–11316). On these devices, Dorsey says an attacker can rebind an external domain to an internal UPnP endpoint on port 1400 that could be used as an intermediary for running Unix shell commands on the device.The researcher says these commands allow an attacker to "map internal and external networks using the traceroute command and probe hosts with ICMP requests with ping using simple POST requests.""An attacker could use a Sonos device as a pivot point to gather useful network topology and connectivity information to be used in a follow up attack," Dorsey said.Unlike Google and Roku, Sonos was far more responsive, and acknowledged the issue right away, promising a fix for mid-July as well.But besides smart home assistants, smart TV software, and smart speakers, Dorsey also looked how DNS rebinding affected home thermostats (CVE-2018–11315).He analyzed Radio Thermostat CT50CT80 devices and found that DNS rebinding attacks worked via a yet-to-be-patched security issue from 2013 (CVE-2013–4860) that exposed the device's API via the internal network with no authentication at all. Dorsey found that he could interact with this API and alter room temperatures."[Changing] temperature can be dangerous, or even deadly in the summer months to an elderly or disabled occupant," he said. "Not to mention that if your device is targeted while you’re on vacation you could return home to a whopper of a utility bill."The issue remains unfixed in Radio thermostats.As for WiFi routers, Dorsey didn't look into these types of devices. Nonetheless, he says most routers are most likely vulnerable. Knowing how many API and UPnP endpoints ship with most routers, DNS rebinding attacks are very likely to be possible on such devices, and the attack is more than ideal for IoT botnet herders.An attacker could use malicious ads (malvertising) to trick the user into making a DNS request to a malicious DNS server, and then, after the DNS rebinding has taken place, use the user's browser as a proxy to send requests to these API and UPnP endpoints with various commands.For example, an attacker could use default credentials to access the router's admin section and make changes to the device, or use the UPnP endpoints to alter Internet gateway settings, configuring HTTP proxies that run on routers —an attack type known as Dorsey hopes that his extensive research on the topic will raise awareness among IoT and smart device vendors about DNS rebinding attacks and the ease with which they can be carried out these days (thanks to malvertising).He hopes that vendors will feature the same levels of protection and security features on API endpoints exposed on the device's internal network, as they do for features exposed on the external WAN interface.The researcher also wants consumers to take notice as well. He recommends that users use services like Dorsey also published a 