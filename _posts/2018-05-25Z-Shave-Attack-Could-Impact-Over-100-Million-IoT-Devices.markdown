---
layout: post
title: Z-Shave Attack Could Impact Over 100 Million IoT Devices
date: 2018-05-25 09:11:08
tourl: https://www.bleepingcomputer.com/news/security/z-shave-attack-could-impact-over-100-million-iot-devices/
tags: [attack]
---
æœ¬å‘¨ï¼ŒPink TestPartnersçš„å®‰å…¨ç ”ç©¶äººå‘˜è§£é‡Šè¯´ï¼Œâ€œæ”»å‡»â€æ˜¯ä»£å·ä¸ºâ€œ0000000000000000â€çš„åŠ å¯†å¯†é’¥ï¼Œå®ƒå¯ä»¥æ¬ºéª—æ™ºèƒ½è®¾å¤‡ä¸å¦ä¸€è®¾å¤‡ã€PCæˆ–æ™ºèƒ½PHPé…å¯¹ã€‚Eåº”ç”¨ç¨‹åºé€šè¿‡æ—§çš„S0æ ‡å‡†ï¼Œå¯ä»¥è§£å¯†ä¸¤ä¸ªä¹‹é—´äº¤æ¢çš„æ‰€æœ‰æµé‡ï¼Œå› ä¸ºè§£å¯†å¯†é’¥æ˜¯ä¼—æ‰€å‘¨çŸ¥çš„ã€‚Pinkæµ‹è¯•äººå‘˜è¯´ï¼Œä»–ä»¬è¯†åˆ«äº†ä¸‰ç§æ–¹æ³•ï¼Œå¯ä»¥ç”¨æ¥é€šè¿‡æ—§S0è€Œä¸æ˜¯S2æ¥æ¬ºéª—ä¸¤ä¸ªè®¾å¤‡æˆå¯¹ï¼Œå³ä½¿ä¸¤è€…éƒ½æ”¯æŒæ›´æ–°çš„SECã€‚Z-Saveæ”»å‡»æ˜¯å±é™©çš„ï¼Œå› ä¸ºé€šè¿‡æ—§ç‰ˆæœ¬çš„Z-Waveé…å¯¹çš„è®¾å¤‡å¯ä»¥æˆä¸ºæ”»å‡»è€…è¿›å…¥æ›´å¤§ç½‘ç»œçš„å…¥å£ç‚¹ï¼Œæˆ–è€…å¯èƒ½å¯¼è‡´çªƒå–ä¸ªäººè´¢äº§ã€‚è™½ç„¶åœ¨æŸäº›åœºæ™¯ä¸­ï¼ŒæŸäº›è®¾å¤‡çš„æ¼æ´å¯èƒ½æ˜¯è½»æµ®çš„ï¼Œä½†å®ƒæ˜¯ä¸€ä¸ªå¤§çš„ã€‚ä¸€ä¸ªå¤§å‹å…¬å¸çš„ç½‘ç»œï¼Œå¦‚æ™ºèƒ½é—¨é”ã€æŠ¥è­¦ç³»ç»Ÿæˆ–ä»»ä½•Z-æ³¢èƒ½è®¾å¤‡ï¼Œä½†åœ¨ä¸€ä¸ªâ€œåœ¨å®‰è£…è¿‡ç¨‹ä¸­ï¼Œä½ éœ€è¦åœ¨å®¶åº­é™„è¿‘çš„å…ˆè¿›è®¾å¤‡ï¼Œâ€ä¸€ä¸ªç¡…å®éªŒå®¤çš„å‘è¨€äººè¯´ï¼Œâ€œå½“å®‰è£…ä¸€ä¸ªæ–°çš„è®¾å¤‡ã€‚æœ‰ä¸€ä¸ªéå¸¸å°çš„æ—¶é—´çª—ï¼ˆæ¯«ç§’ï¼‰è¿«ä½¿S2åˆ°S0é€†è½¬ï¼Œâ€œä»–è¡¥å……è¯´ã€‚æˆ¿ä¸»æˆ–ä¸“ä¸šå®‰è£…è€…å°†åœ¨å®‰è£…è¿‡ç¨‹ä¸­å§‹ç»ˆå­˜åœ¨ï¼Œå¹¶ä¸”æ˜¯å”¯ä¸€å¯ä»¥å¯åŠ¨åŒ…å«è¿‡ç¨‹çš„äººã€‚â€œä½†æ˜¯Pink TestPartnerså¯¹è¿™ä¸€è¯´æ³•æå‡ºå¼‚è®®ï¼Œç§°è¿™å¹¶ä¸æ˜¯ä¸€ä¸ªä¸ä¾¿ã€‚â€å½“æˆ‘ä»¬è¯´ä¸»åŠ¨æ”»å‡»è€…â€œæˆ‘ä»¬å¹¶ä¸æ„å‘³ç€ä¸€ä¸ªå®¶ä¼™â€ã€‚Yååœ¨ä¸€è¾†è£…æœ‰ç¬”è®°æœ¬ç”µè„‘çš„è½¦é‡Œï¼Œâ€œPen Testçš„Andrew Tierneyè¯´ã€‚â€ä¸€ä¸ªç”µæ± ä¾›ç”µçš„æ‰çº¿ç›’å¯ä»¥åœ¨è¯¥å±æ€§ä¹‹å¤–æ”¾ç½®æ•°å‘¨ï¼Œç­‰å¾…é…å¯¹äº‹ä»¶å‘ç”Ÿã€‚â€Tierneyåæ¥åœ¨Twitterä¸Šè¡¥å……è¯´ï¼Œæ”»å‡»è€…è¿˜å¯ä»¥éƒ¨ç½²é’ˆå¯¹ç›®æ ‡è®¾å¤‡çš„æ‹’ç»æœåŠ¡æ¼æ´ï¼Œè¿«ä½¿å…¶ç¦»çº¿ï¼Œå¹¶è¯±éª—æ‰€æœ‰è€…åœ¨Atacä¸Šé‡æ–°é…å¯¹ã€‚ä½†ç¡…å®éªŒå®¤è¿˜å£°ç§°ï¼ŒZ-Såˆ®çš„æ”»å‡»ä¹Ÿå¾ˆéš¾å®ç°ï¼Œå› ä¸ºä»»ä½•æ—¶å€™è®¾å¤‡éƒ½ä¼šé€šè¿‡S0è€Œä¸æ˜¯S2é…å¯¹ï¼šâ€œæ™ºèƒ½å®¶å±…æ§åˆ¶å™¨æˆ–ç½‘å…³å¦‚æœåœ¨å®‰è£…è¿‡ç¨‹ä¸­S2æ¢å¤åˆ°S0ï¼Œå°†æ€»æ˜¯é€šçŸ¥ç”¨æˆ·ã€‚â€åœ¨Pinkæµ‹è¯•å°ç»„å½•åˆ¶çš„æ¼”ç¤ºè§†é¢‘ä¸­ï¼Œè¿™ä¸€è¯´æ³•è¢«è¯æ˜æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºç ”ç©¶äººå‘˜æ²¡æœ‰æ”¶åˆ°ä»»ä½•è­¦æŠ¥ã€‚Z-å‰ƒé¡»æ”»å‡»å¹¶ä¸æ˜¯æ–°çš„ã€‚å…¶ä»–ç ”ç©¶äººå‘˜æŒ‡å‡ºï¼Œè¿™ä¸ªé—®é¢˜æ²¡æœ‰å¾—åˆ°è¶³å¤Ÿçš„é‡è§†ï¼Œå› ä¸ºS2-S0é™çº§è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªå¯æ¥å—çš„é£é™©æš‚æ—¶ï¼Œå› ä¸ºè®¾å¤‡éœ€è¦ä¸€ä¸ªé€€é¿æœºåˆ¶çš„å…¼å®¹æ€§åŸå› ï¼Œä»¥è¿æ¥æ—§çš„S0è®¾å¤‡ä¸æ–°çš„S2è®¾å¤‡ã€‚UTäº”å¹´åï¼Œè®¾å¤‡ä»åœ¨æ”¯æŒZ-Wave S0çš„èˆªè¿ï¼Œå°½ç®¡è¿™ä¸ªé—®é¢˜ä¸èƒ½è¢«å¿½è§†æ›´é•¿çš„æ—¶é—´ï¼Œå› ä¸ºZ-Waveçš„æ™®åŠåœ¨IOTè®¾å¤‡åˆ¶é€ å•†ä¸­è¶Šæ¥è¶Šå¤§ï¼Œå› ä¸ºä¸è“ç‰™ç›¸æ¯”ï¼Œå…¶ä¼˜è¶Šçš„èŒƒå›´ã€‚è¯¥åè®®è¢«è®¤ä¸ºå·²ç»éƒ¨ç½²äº†è¶…è¿‡2400ä¸ªæ™ºèƒ½è®¾å¤‡æ¨¡å‹ï¼Œå¹¶è¢«1äº¿å¤šä¸ªè®¾å¤‡æ‰€ä½¿ç”¨ã€‚æ›´å¤šçš„æ–°é—»æ–‡ç« å’Œå…³æ³¨Z-åˆ®åˆ®æ”»å‡»å¯èƒ½æ˜¯ä¸€äº›è®¾å¤‡åˆ¶é€ å•†éœ€è¦åˆ‡æ¢åˆ°æ›´æ–°å’Œæ›´å®‰å…¨çš„åè®®ç‰ˆæœ¬çš„æ¨åŠ¨ã€‚
The The attack —codenamed The problem, as security researchers from Pen Test Partners have explained this week, is that all S0 traffic is secured by default with an encryption key of "0000000000000000."An attacker that can trick a smart device into pairing with another device, a PC, or a smartphone app via the older S0 standard, can later decrypt all traffic exchanged between the two because the decryption key is widely known.The Pen Test crew say they identified three methods that can be used to trick two devices into pairing via the old S0 instead of S2, even if both support the newer security standard.The Z-Shave attack is dangerous because devices paired via an older version of Z-Wave can become a point of entry for an attacker into a larger network, or can lead to the theft of personal property.While this flaw might prove frivolous for some devices in some scenarios, it is a big issue for others —such as smart door locks, alarm systems, or any Z-Wave-capable device on the network of a large corporation.But in a "You would need advanced equipment in proximity to the home during the short installation process," a Silicon Labs spokesperson said."When installing a new device there is a very small window of time (milliseconds) to force the S2 to S0 reversion," he added. "The homeowner or professional installer will always be present during installation and is the only one who can initiate the inclusion process."But Pen Test Partners dispute this latter claim, saying this is not actually an inconvenience."When we say active attacker – we don’t mean a guy in a hoody sat in a car with a laptop," said Pen Test's Andrew Tierney. "A battery-powered drop-box could be left outside the property for weeks, waiting for a pairing event to occur."Tierney later added on Twitter that an attacker could also deploy a denial-of-service flaw against a targeted device to force it offline and trick the owner into re-pairing it at the attacker's convenience.But Silicon Labs also claimed that the Z-Shave attack would also be hard to pull off because any time the devices would pair via S0 instead of S2 "the smart home controller or gateway will ALWAYS notify the user if S2 is reverted to S0 during the installation process."Nonetheless, this claim was proven to be wrong in a demo video recorded by the Pen Test team, where researchers didn't receive any alert.The Z-Shave attack isn't actually new. Other researchers pointed out At the time, the issue was not given enough importance because the S2-to-S0 downgrade was considered an acceptable risk for the time being, as devices needed a fallback mechanism for compatibility reasons —to interconnect the old S0 devices with the newer S2 devices.But five years later, devices are still shipping with support for Z-Wave S0, despite The issue can't be ignored for longer because Z-Wave's popularity is growing among IoT device makers due to its superior range when compared to Bluetooth. The protocol is believed to have been deployed with over 2,400 smart device models and in use by over 100 million devices.More news articles and attention givet to the Z-Shave attack might be the push that some device makers need to switch to the newer and more secure version of the protocol.