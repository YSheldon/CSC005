---
layout: post
title: VPNFilter update: More bad news for routers
date: 2018-06-07 12:00:42
tourl: https://www.welivesecurity.com/2018/06/07/vpnfilter-update-bad-news-routers/
tags: [attack]
---
å¯¹VPNFLASHçš„æ–°ç ”ç©¶å‘ç°ï¼Œæ›´å¤šçš„è®¾å¤‡å—åˆ°æ¶æ„è½¯ä»¶çš„æ”»å‡»ï¼Œè¿™æ¯”æœ€åˆçš„æƒ³æ³•æ›´ä¸ºæ¶åŠ£ï¼Œä½¿å¾—è·¯ç”±å™¨çš„é‡æ–°å¯åŠ¨å’Œæ›´ä½³æ›´ä¸ºè¿«åˆ‡ã€‚TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTè·¯ç”±å™¨è¢«è®¤ä¸ºæ˜¯ç‰¹åˆ«å±é™©çš„æ¶æ„ä»£ç ç§°ä¸ºVPNFã€‚æ ¹æ®æ€ç§‘çš„å¡”ç½—æ–¯æƒ…æŠ¥é›†å›¢æ­£åœ¨è¿›è¡Œçš„ç ”ç©¶ã€‚è¿™äº›æœ‰56ä¸ªé¢å¤–çš„æ¨¡å‹å’Œäº”ä¸ªæ–°çš„ä¾›åº”å•†å—åˆ°å½±å“ï¼Œè¶Šæ¥è¶Šå¤šçš„å¯èƒ½ä¼šè¢«è¯†åˆ«ã€‚è¿™å¢å¼ºäº†å…ˆå‰çš„å»ºè®®ï¼šä¸ç®¡ä½ ä½¿ç”¨çš„è·¯ç”±å™¨çš„å‹å·æˆ–å‹å·å¦‚ä½•ï¼Œä½ éƒ½åº”è¯¥é‡‡å–è¡ŒåŠ¨ï¼ˆé™¤éä½ å·²ç»æ”¶åˆ°ISPæˆ–ä¾›åº”å•†çš„åšå®ä¿è¯ï¼Œä½ çš„ç‰¹å®šè·¯ç”±å™¨ä¸æ˜“å—æ”»å‡»ï¼‰ã€‚è¶…è¿‡50ä¸ªå›½å®¶çš„æˆåƒä¸Šä¸‡çš„è·¯ç”±å™¨å·²ç»è¢«æ”»å…‹ã€‚è¢«æ¶æ„è½¯ä»¶ç§°ä¸ºå¾ˆå¤šæ¶æ„è½¯ä»¶ï¼ŒVPNFilteræ˜¯æ¨¡å—åŒ–çš„ï¼Œå¯ä»¥é€šè¿‡å‘½ä»¤å’Œæ§åˆ¶ï¼ˆC2ï¼‰ç³»ç»Ÿåœ¨äº’è”ç½‘ä¸Šé€šä¿¡ï¼Œä»¥ä¸‹è½½é¢å¤–çš„æ¨¡å—ã€‚è·¯ç”±å™¨çš„ç ”ç©¶æ˜¯ä¸“é—¨çš„è®¡ç®—è®¾å¤‡ï¼Œå®ƒå¯ä»¥åœ¨ç½‘ç»œä¹‹é—´ä¼ è¾“ä¸šåŠ¡ï¼Œä¾‹å¦‚ï¼Œåœ¨ä½ åŠå…¬å®¤çš„ç½‘ç»œå’Œè¢«ç§°ä¸ºå› ç‰¹ç½‘çš„å…¨çƒç½‘ç»œä¹‹é—´ã€‚è·¯ç”±å™¨æœ‰ä¸‰ä¸ªå­˜å‚¨ä»£ç å’Œä¿¡æ¯çš„åœ°æ–¹ï¼šè§„åˆ™å­˜å‚¨å™¨ï¼Œå®ƒæ˜¯æ˜“å¤±æ€§çš„ï¼Œå½“å®ƒå¤±å»åŠŸç‡æ—¶å¤±å»å®ƒçš„å†…å®¹ï¼›å³ä½¿åœ¨ç”µæºå…³é—­æ—¶ä¿ç•™å…¶å†…å®¹çš„éæ˜“å¤±æ€§å­˜å‚¨å™¨ï¼›å’Œå›ºä»¶ï¼Œå…¶å†…å®¹ç›¸å¯¹éš¾ä»¥æ”¹å˜ã€‚VPNFLASH Sä»£ç é©»ç•™åœ¨æ˜“å¤±æ€§å­˜å‚¨å™¨ä¸­ï¼Œå¹¶é€šè¿‡é‡æ–°å¯åŠ¨æˆ–å¾ªç¯è¿è¡Œç”µæºï¼ˆå³å…³æ‰ç”µæºç­‰å¾…30ç§’ï¼Œç„¶åå†æ¬¡ä¸Šç”µï¼‰è¢«æ“¦é™¤ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå®‰å…¨ä¸“å®¶å’ŒFBIé‡å¯ä¸ä¼šåˆ é™¤VPNFLASHå¯èƒ½å†™å…¥éæ˜“å¤±æ€§å­˜å‚¨å™¨çš„ä»£ç çš„åŸå› ã€‚æ¸…é™¤éæ˜“å¤±æ€§å­˜å‚¨å™¨éœ€è¦ä¸€ä¸ªè®¾å¤‡é‡ç½®ï¼Œä½†æ˜¯é™¤éä½ çŸ¥é“ä½ åœ¨åšä»€ä¹ˆï¼Œå¦åˆ™ä½ ä¸åº”è¯¥æ‰§è¡Œé‡ç½®ï¼ˆå¦‚æœä½ çš„è·¯ç”±å™¨æ˜¯ç”±ISPæä¾›çš„ï¼Œè¯·å‚é˜…æŒ‡ä»¤å’Œå»ºè®®ï¼Œå¦‚æœä»–ä»¬è¿˜æ²¡æœ‰é€šçŸ¥ä½ å¹¶é€šçŸ¥ä½ ï¼Œä½ åº”è¯¥è”ç³»ä»–ä»¬ã€‚è¦è€ƒè™‘çš„å…¶ä»–æ­¥éª¤æ˜¯å°†è·¯ç”±å™¨å‡çº§åˆ°æœ€æ–°çš„å›ºä»¶ï¼Œæ›´æ”¹é»˜è®¤çš„ç®¡ç†å¯†ç ï¼Œç¦ç”¨è¿œç¨‹ç®¡ç†ã€‚æ‰§è¡Œè¿™äº›åŠŸèƒ½çš„æŒ‡ä»¤å¯ä»¥åœ¨è·¯ç”±å™¨åˆ¶é€ å•†çš„ç½‘ç«™ä¸Šæ‰¾åˆ°ã€‚æˆ‘ç¡®ä¿¡åœ¨æœªæ¥çš„æ—¥å­é‡Œå°†ä¼šæœ‰æ›´å¤šå…³äºVPNFLASEå’Œè·¯ç”±å™¨å®‰å…¨çš„æ–‡ç« ã€‚åŸºäºç›®å‰è¯»è€…çš„é—®é¢˜ï¼Œæˆ‘ä»¬å·²ç»äº†è§£åˆ°è·¯ç”±å™¨çš„çŸ¥è¯†å’Œå¦‚ä½•ç¡®ä¿å®ƒä»¬åœ¨è·¯ç”±å™¨ç”¨æˆ·ç¾¤ä½“ä¸­æœ‰å¾ˆå¤§çš„å·®åˆ«ã€‚äº‹å®ä¸Šï¼Œç­”æ¡ˆæ¯”ä½ æƒ³è±¡çš„è¦æ£˜æ‰‹ã€‚è®¸å¤šå®¶åº­å’Œå°åŠå…¬å®¤éƒ½æœ‰å„ç§å„æ ·çš„ç›’å­ï¼Œå®ƒä»¬ä¸€èµ·å·¥ä½œï¼Œå°†äº’è”ç½‘ä¼ é€åˆ°ä»–ä»¬çš„è®¡ç®—æœºã€æ™ºèƒ½æ‰‹æœºã€å¹³æ¿ç”µè„‘ã€æ™ºèƒ½ç”µè§†ã€æ™ºèƒ½æ’æ¸©å™¨ç­‰ç­‰ã€‚è¿™ç§ä¼ è¾“å¯ä»¥æ˜¯æ— çº¿çš„ï¼Œé€šè¿‡Wi-Fiæ¥å…¥ç‚¹ï¼Œæˆ–è€…é€šè¿‡ä»¥å¤ªç½‘æœ‰çº¿è¿æ¥ï¼Œé€šè¿‡äº¤æ¢æœºã€‚ä»ISPå‘å‡ºçš„ä¿¡å·å¯èƒ½éœ€è¦ç»è¿‡è°ƒåˆ¶è§£è°ƒå™¨æ‰èƒ½åœ¨è·¯ç”±å™¨å°†å…¶å‘é€åˆ°æ­£ç¡®çš„è®¾å¤‡ä¹‹å‰ã€‚ä¸‹é¢çš„å›¾è¡¨å¯èƒ½æœ‰åŠ©äºå¯è§†åŒ–è¿™ä¸€ç‚¹ï¼šå¹¸è¿çš„æ˜¯ï¼Œä½†æœ‰æ—¶ä»¤äººå›°æƒ‘çš„æ˜¯ï¼Œæ‰€æœ‰çš„åŠŸèƒ½éƒ½å¯ä»¥ç”±ä¸€ä¸ªå•ç‹¬çš„ç›’å­æä¾›ï¼Œå°½ç®¡å®ƒå…·æœ‰è·¯ç”±å™¨åŠŸèƒ½ï¼Œä½†å®ƒå¯èƒ½å…·æœ‰æ— çº¿èƒ½åŠ›ï¼Œå³ä½¿å®ƒæ²¡æœ‰å¤©çº¿ï¼Œä¹Ÿä¸å¯èƒ½è¢«ç§°ä¸ºè·¯ç”±å™¨ã€‚IKEä¸‹é¢çš„ä¾‹å­ï¼Œç±»ä¼¼äºæˆ‘å®¢å…é‡Œçš„é‚£ä¸ªä¾‹å­ã€‚å¸Œæœ›è¿™äº›åŸºæœ¬çš„æè¿°èƒ½å¸®åŠ©ä½ è¯†åˆ«ä½ å½“å‰çš„è®¾ç½®ï¼Œç„¶åä½ å¯ä»¥é‡æ–°å¯åŠ¨æ­£åœ¨è¿›è¡Œè·¯ç”±çš„ç›’å­ã€‚è€å®è¯´ï¼Œå¦‚æœä½ æœ‰å¤šä¸ªç®±å­è€Œä¸æ˜¯ä¸€ä¸ªç®±å­ï¼ŒæŠŠå®ƒä»¬å…¨éƒ¨å…³å¥½ï¼Œç„¶åå†é‡æ–°æ‰“å¼€å°±ä¸ä¼šæœ‰ä»€ä¹ˆä¼¤å®³ã€‚äº‹å®ä¸Šï¼Œä¸Šæ¬¡ä½ æ‰“ç”µè¯ç»™ISPæŠ±æ€¨ä½ çš„äº’è”ç½‘è¿æ¥æ€§èƒ½ä¸ä½³æ—¶ï¼Œä½ å¯èƒ½è¢«å‘ŠçŸ¥è¦è¿™ä¹ˆåšã€‚æˆ‘ä¸æ‰“ç®—è½»è§†è¿™ç§å¨èƒã€‚VPNFLASEæ˜¾ç„¶æ˜¯éå¸¸è®¨åŒçš„æ¶æ„è½¯ä»¶ï¼Œæˆ‘ä»¬ç°åœ¨çŸ¥é“å®ƒæœ‰ä¸­é—´äººï¼ˆMITMï¼‰æ”»å‡»èƒ½åŠ›ï¼ˆæŠ¥å‘Šï¼‰ã€‚åœ¨è¿™ä¸ªéå¸¸å¼ºå¤§å’Œéå¸¸è‚®è„çš„VPNFLASTæ¶æ„è½¯ä»¶ä¸­å¼ºè°ƒï¼Œå¤„äºé£é™©çš„è®¾å¤‡æ˜¯å®¶åº­åŠå…¬å®¤å’Œå°å‹åŠå…¬è·¯ç”±å™¨ï¼Œä½†è¿™å¹¶ä¸æ„å‘³ç€ä¼ä¸šæ²¡æœ‰ä»€ä¹ˆå¯æ‹…å¿ƒçš„ã€‚ç»éªŒå‘Šè¯‰æˆ‘ä»¬ï¼Œåœ¨å¤§å¤šæ•°å¤§å‹å…¬å¸ç½‘ç»œæˆ–è¿æ¥åˆ°è¿™äº›ç½‘ç»œä¸Šå¯èƒ½ä¼šæœ‰è¿™äº›è®¾å¤‡ã€‚å®ƒä»¬å¯èƒ½æ˜¯å›°æ‰°æ¯ä¸ªä¼ä¸šçš„é˜´å½±çš„ä¸€éƒ¨åˆ†ï¼Œæˆ–è€…å®‰è£…åœ¨åˆ†æ”¯æœºæ„ä¸­ï¼Œç¦æ­¢ä½¿ç”¨æ­¤ç±»è®¾å¤‡çš„æ”¿ç­–æ²¡æœ‰å¾—åˆ°æœ‰æ•ˆå®æ–½ï¼Œç„¶åè¿˜æœ‰å‘˜å·¥è¿œç¨‹å·¥ä½œã€è¿æ¥åˆ°å†…éƒ¨ç½‘ç»œã€ç™»å½•æœåŠ¡å™¨Fçš„é—®é¢˜ã€‚æˆ–ç»´ä¿®ç­‰ã€‚ç°åœ¨å°†æ˜¯ä½ çš„ç½‘ç»œå®‰å…¨äººå‘˜ç ”ç©¶VPNFLASTæ¶æ„è½¯ä»¶çš„ç»†èŠ‚çš„å¥½æ—¶æœºï¼Œå¹¶ç¡®å®šå®ƒæ˜¯å¦å¯¹è¿™äº›è¿æ¥çš„æœºå¯†æ€§å’Œå®Œæ•´æ€§æ„æˆé£é™©ã€‚
New research into VPNFilter finds more devices hit by malware that’s nastier than first thought, making rebooting and remediating of routers more urgent.tttttttttttttttAt the bottom of this article is a revised list of routers believed to be at particular risk from the malicious code known as VPNFilter, according to ongoing research by Cisco’s Talos Intelligence Group. These With 56 additional models and five new vendors impacted, it is increasingly likely that even more will be identified. This reinforces previous advice: you should take action regardless of the make or model of router you are using (unless you have received solid assurances from your ISP or vendor that your specific router is not vulnerable).Hundreds of thousands of routers in more than 50 countries have been compromised by malware dubbed Like a lot of malware, VPNFilter is modular and can communicate over the internet with a Command and Control (C2) system to download additional modules. Research into Routers are specialized computing devices that direct traffic between networks, for example, between the network in your office and the global network known as the internet. Routers have three places to store code and information: regular memory, which is “volatile” and loses its contents when it loses power; non-volatile memory that retains its contents even when the power is turned off; and firmware, the contents of which are relatively difficult to change.Much of VPNFilter’s code resides in volatile memory and is wiped out by a reboot or “cycling the power” (i.e. power it off – wait 30 seconds – then power it on again). That is why the security experts and the FBI However, a reboot does not remove code that VPNFilter may have written to non-volatile memory. Clearing non-volatile memory requires a device reset, but you should NOT perform a reset unless you know what you are doing (see the instructions and advice in this If your router is supplied by your ISP you should contact them for instructions if they have not already alerted you and advised you of the situation.Other steps to consider are upgrading your router to the latest firmware, changing the default administration password, and disabling remote administration. Instructions to perform these functions can be found on the router maker’s website.I am sure there will be more articles related to VPNFilter and router security on WeLiveSecurity in the coming days. We already get the sense, based on questions from readers so far, that knowledge of routers and how to secure them varies considerably within the population of router users.One basic question – do I have a router? – is actually trickier to answer than you might think. Many homes and small offices have a variety of boxes that work together to deliver the internet to their computers, smartphones, tablets, smart TVs, clever thermostats, and so on.That delivery can be wireless, via a Wi-Fi access point, or wired through Ethernet cables, via a switch. The signal from your ISP may need to go through a modem before the router sends it onward to the right device. The following diagram might help visualize this:Fortunately, but sometimes confusingly, all of that functionality can be provided by a single box, which may not be called a router, even though it has router capabilities (and it may have wireless capability even though it does not have antennae – like the example on the right below, which is similar to the one in my living room).Hopefully these basic descriptions will help you identify your current setup and you can proceed to reboot the box that is doing the routing. To be honest, if you have multiple boxes instead of one, it won’t hurt to turn them all off and then back on again. Indeed, you may have been told to do that the last time you called your ISP to complain about your internet connection underperforming.I don’t mean to make light of this threat – VPNFilter is clearly very nasty malware which we now know has man-in-the middle (MITM) attack capabilities (Reporting on this very powerful and very nasty VPNFilter malware has stressed that the “at risk” devices are home office and small office routers, but that doesn’t mean enterprises have nothing to fear. Experience tells us there are likely to be some of these devices on most big company networks or connecting to those networks. They could be a part of the “shadow IT” that haunts every enterprise, or installed in branch offices where policies that prohibit the use of such devices are not well enforced.And then there is the question of employees working remotely, connecting to your internal network, logging into servers for maintenance, and so on. Now would be a good time for your cybersecurity folks to study the details of the VPNFilter malware and determine if it poses a risk to the confidentiality and integrity of those connections.