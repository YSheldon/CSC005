---
layout: post
title: Firmware Vulnerabilities Disclosed in Supermicro Server Products
date: 2018-06-07 21:05:20
tourl: https://www.bleepingcomputer.com/news/security/firmware-vulnerabilities-disclosed-in-supermicro-server-products/
tags: [exploit]
---
å®‰å…¨ç ”ç©¶äººå‘˜å‘ç°äº†å½±å“è¶…å¾®å‹æœåŠ¡å™¨äº§å“å›ºä»¶çš„æ¼æ´ã€‚ç”±Exelpsisimå›¢é˜Ÿå‘ç°ï¼Œè¿™äº›æ¼æ´å½±å“äº†è¶…é¾„äº§å“å’Œè¾ƒæ–°å‹å·çš„è¶…å¾®å‹äº§å“ï¼Œä½†ä¾›åº”å•†æ­£åœ¨è‡´åŠ›äºè§£å†³è¿™äº›é—®é¢˜ã€‚æŠŠè¶…å¾®å‹äº§å“çš„å®‰å…¨ç½®äºç›´æ¥é£é™©ï¼Œå› ä¸ºå®ƒä»¬åªèƒ½é€šè¿‡å·²ç»åœ¨ç³»ç»Ÿä¸Šè¿è¡Œçš„æ¶æ„è½¯ä»¶/ä»£ç ï¼ˆåˆåæ¶æ„è½¯ä»¶ï¼‰æ¥åˆ©ç”¨ã€‚ç„¶è€Œï¼Œåˆ©ç”¨è¿™äº›æ¼æ´ï¼Œæ¶æ„è½¯ä»¶é€šè¿‡è·å¾—éšè—åœ¨ç¡¬ä»¶å›ºä»¶ä¸­çš„æœåŠ¡å™¨OSç”Ÿå­˜èƒ½åŠ›æ¥è·å¾—å—æ„ŸæŸ“ç³»ç»Ÿçš„å‡ ä¹æ°¸ä¹…ç«‹è¶³ç‚¹ã€‚åœ¨å›ºä»¶çš„ä»£ç ï¼Œä½†åœ¨ä¸€äº›è¶…å¾®å‹äº§å“çš„é…ç½®ã€‚ç ”ç©¶äººå‘˜è¯´ï¼Œè¿™äº›äº§å“ä¸­æœ‰ä¸€äº›å›ºä»¶ä½¿ç”¨ä¸æ­£ç¡®çš„è®¾ç½®ä¸ºâ€œæè¿°ç¬¦åŒºåŸŸâ€ã€‚æè¿°ç¬¦åŒºåŸŸæ˜¯åŸºäºè‹±ç‰¹å°”çš„èŠ¯ç‰‡ç»„çš„å®‰å…¨ç‰¹æ€§ã€‚è¿™ä¸ªè®¾ç½®å‘Šè¯‰èŠ¯ç‰‡ç»„è‡ªå·±çš„é—ªå­˜å­˜å‚¨çš„å¤–éƒ¨åŒºåŸŸå¯ä»¥è®¿é—®å­˜å‚¨æ•°æ®ï¼Œä¾‹å¦‚å›ºä»¶æˆ–é…ç½®æ–‡ä»¶ã€‚æ ¹æ®EcExpsiUMçš„ç ”ç©¶äººå‘˜ï¼Œä¸€äº›è¶…å¾®å‹äº§å“æœ‰ä¸€ä¸ªä¸æ­£ç¡®è®¾ç½®çš„æè¿°ç¬¦åŒºåŸŸï¼Œå…è®¸è¿è¡Œåœ¨OSä¸Šçš„è½¯ä»¶ï¼ˆå¦‚æ¶æ„è½¯ä»¶ï¼‰ä¿®æ”¹æè¿°ç¬¦åŒºåŸŸï¼Œç„¶åç¯¡æ”¹æœ¬åœ°å›ºä»¶ã€‚â€œEcclipsiUMç ”ç©¶äººå‘˜é€šè¿‡å¯¹å„ç§æœåŠ¡å™¨å›ºä»¶æ¨¡å‹çš„è¿è¡Œæ—¶é—´æ£€æŸ¥è§‚å¯Ÿåˆ°è„†å¼±çš„æè¿°ç¬¦è®¿é—®æ§åˆ¶ï¼Œâ€Eclipsisimå›¢é˜Ÿåœ¨â€œæ‰‹åŠ¨åˆ†æâ€ä¸­å‘ç°äº†å¤šæœåŠ¡å™¨æ¨¡å¼ã€‚å…è®¸ä»ä¸»æœºè½¯ä»¶å†™å…¥Flashæè¿°ç¬¦ã€‚æ ¹æ®è¶…å¾®å‹ï¼Œæˆ‘ä»¬å›é¡¾çš„ä¸€äº›äº§å“å¯ä»¥è¿½æº¯åˆ°2008ï¼Œç›®å‰æ˜¯EOLï¼Œä¸å†æ”¯æŒã€‚â€œä½†æ˜¯åœ¨ä¿®æ”¹ä¸€äº›æè¿°ç¬¦åŒºåŸŸè®¾ç½®å¯èƒ½å¯¹ä¸€äº›è¶…å¾®å‹äº§å“æ¥è¯´ï¼Œç¯¡æ”¹æœ¬åœ°å›ºä»¶å¹¶ä¸åƒå¬èµ·æ¥é‚£ä¹ˆå®¹æ˜“ï¼Œå°±åƒå‡ ä¸ªå®‰å…¨ä¸€æ ·ã€‚æœºåˆ¶é˜²æ­¢æ¶æ„å‚ä¸è€…æ”¹å˜è®¡ç®—æœºæˆ–æœåŠ¡å™¨æœ€é‡è¦çš„ä»£ç ã€‚è¿™é‡Œæ˜¯Eclipsisimå›¢é˜Ÿå‘ç°çš„ç¬¬äºŒä¸ªç³»åˆ—é—®é¢˜æ‰€åœ¨ã€‚â€œæˆ‘ä»¬é€šè¿‡å„ç§ç³»ç»Ÿçš„è¿è¡Œæ—¶æ£€æŸ¥è§‚å¯Ÿåˆ°äº†ä¸å®‰å…¨çš„å›ºä»¶æ›´æ–°ã€‚è¯¥æ‰‹å†Œåˆ†æå‘ç°ï¼Œè¶…å¾®å‹X9DRIL-LN4F+å’ŒX10SLM Fç³»ç»Ÿæ²¡æœ‰å®‰å…¨åœ°éªŒè¯å›ºä»¶æ›´æ–°ï¼Œâ€œç ”ç©¶å°ç»„è¯´ï¼Œâ€æˆ‘ä»¬é€šè¿‡æ•…æ„ä¿®æ”¹å®˜æ–¹è¶…å›ºä»¶å›¾åƒä¸­çš„äºŒè¿›åˆ¶æ–‡ä»¶å¹¶è§‚å¯Ÿåˆ°ç³»ç»Ÿå›ºä»¶ä»ç„¶è¯å®äº†è¿™ä¸€ç»“æœã€‚æ¥å—å¹¶å®‰è£…äº†ä¿®æ”¹åçš„è½¯ä»¶åŒ…ã€‚â€œä½†æ˜¯é—®é¢˜å¹¶æ²¡æœ‰å°±æ­¤åœæ­¢ï¼Œè€Œä¸”Eclipsisimå›¢é˜Ÿä¹Ÿæ³¨æ„åˆ°å›ºä»¶æ˜ åƒç¼ºå°‘åå›æ»šä¿æŠ¤ã€‚è¿™ç§åå›æ»šä¿æŠ¤å¯¹äºä¾›åº”å•†æ£€æŸ¥å›ºä»¶çœŸå®æ€§çš„æƒ…å†µæ˜¯è‡³å…³é‡è¦çš„ã€‚å›ºä»¶åå›æ»šã€‚ä¿æŠ¤å°†é˜²æ­¢æ”»å‡»è€…ç”¨ä¸€ä¸ªæ—§çš„ï¼ˆåˆæ³•çš„ï¼‰å›ºä»¶æ˜ åƒæ›¿æ¢æ–°å›ºä»¶ï¼Œè¿™äº›ç¼ºé™·åŒ…å«æ”»å‡»è€…å¯ä»¥åˆ©ç”¨çš„æ¼æ´ï¼Œå¹¶åœ¨å®Œå…¨è„†å¼±çš„ç³»ç»Ÿä¸­è·å¾—ç«‹è¶³ç‚¹ã€‚Eclypsiumè¯´ï¼šâ€œè¶…çº§å¾®å…¬å¸ä¸€ç›´æ”¯æŒæˆ‘ä»¬çš„åŠªåŠ›å’Œä¼˜å…ˆç†è§£å’Œå‡è½»æˆ‘ä»¬å‘ç°çš„é—®é¢˜ï¼Œâ€å¯¹äºç›®å‰çš„ä¸€ä»£äº§å“ï¼Œè¶…å¾®å‹è¡¨ç¤ºä»–ä»¬å·²ç»å®ç°äº†ç­¾ç½²å›ºä»¶æ›´æ–°ã€‚å¯¹äºä¸€äº›äº§å“ï¼Œå¹¶ä½¿è¿™ç§æ›´æ–°é€šå¸¸é€‚ç”¨äºæ‰€æœ‰æœªæ¥çš„ç³»ç»Ÿã€‚â€œåŒæ ·ï¼Œå¯¹äºéœ€è¦å®šåˆ¶å’Œé”å®šå›ºä»¶ç‰ˆæœ¬çš„å›æ»šèƒ½åŠ›çš„OEMå®¢æˆ·ï¼Œç¡®ä¿ä¸šåŠ¡è¿ç»­æ€§ï¼Œè¶…å¾®å‹è¡¨ç¤ºå®ƒä»¬æ”¯æŒåå›æ»šã€‚å¯¹äºä»–ä»¬çš„X11ä»£å›ºä»¶ï¼Œâ€œSPI Flashæè¿°ç¬¦åœ¨å¤§å¤šæ•°ç”µè·¯æ¿ä¸Šæ˜¯åªè¯»çš„ï¼Œæˆ‘ä»¬æ­£åœ¨å¸®åŠ©è¶…å¾®å‹è¯†åˆ«ç‰¹å®šçš„æ¨¡å‹ï¼Œå…¶ä¸­å¯èƒ½è®¾ç½®ä¸æ­£ç¡®ã€‚â€å¯¹äºè¶…çº§æœåŠ¡å™¨ç¡¬ä»¶çš„æ‰€æœ‰è€…ï¼ŒEcclipsimå·²ç»å‘å¸ƒäº†å¦‚ä½•æ£€æŸ¥æè¿°ç¬¦ACCçš„æŒ‡ä»¤ã€‚ESSæ§åˆ¶è‡ªå·±çš„ç³»ç»Ÿã€‚è¿™äº›ç¨‹åºéœ€è¦å®‰è£…å’Œè¿è¡ŒBLASHè®¡ç®—æœºåœ¨æœ¬æ–‡å‘è¡¨ä¹‹å‰å‘è¶…å¾®æ—¥å‘é€è¯„è®ºè¯·æ±‚ã€‚æˆ‘ä»¬è¦æ±‚è¶…å¾®å¾®å…¬å¸ç¡®è®¤Eclipsisimçš„ç ”ç©¶ï¼Œå¹¶è¯¢é—®å—æŠ¥å‘Šçš„å®‰å…¨é—®é¢˜å½±å“çš„è¶…å¾®å‹å¹³å°çš„åˆ—è¡¨ï¼Œä½†åœ¨æœ¬æ–‡å‘è¡¨ä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜æ²¡æœ‰å›éŸ³ã€‚TEDæ¨¡å—ï¼ŒEcclipsieCoé¦–å¸­æ‰§è¡Œå®˜å’ŒFounder Yuriy Bulyginå¾ˆå¥½åœ°åˆ†äº«äº†ä»–ä»¬æ‰€ç›¸ä¿¡çš„å—å½±å“çš„è¶…å¾®å‹äº§å“åˆ—è¡¨ã€‚â€œå¯¹äºä¸¢å¤±çš„UEFIæ›´æ–°ä¿æŠ¤ï¼Œå®ƒçœ‹èµ·æ¥æ˜¯X8ã€X9ã€X10ä»£æœåŠ¡å™¨äº§å“çš„å¤§å¤šæ•°æˆ–å…¨éƒ¨ï¼Œä»¥åŠXçš„å¤§éƒ¨åˆ†ã€‚11ä»£æœåŠ¡å™¨äº§å“å—åˆ°å½±å“ï¼Œâ€œBulyginé€šè¿‡ç”µå­é‚®ä»¶å‘Šè¯‰ç”µè„‘ã€‚â€æˆ‘ä»¬ä¸çŸ¥é“å—å½±å“çš„æ¨¡å‹çš„ç¡®åˆ‡æ•°ç›®ï¼Œä½†æˆ‘ä»¬å‘ç°äº†1ä¸ªã€‚
Security researchers have uncovered vulnerabilities affecting the firmware of Supermicro server products.Discovered by the Eclypsium team, these vulnerabilities affect both older and newer models of Supermicro products, but the vendor is working on addressing the issues.These vulnerabilities do not put the safety of Supermicro products at direct risk, as they can only be exploited via malicious software/code (aka malware) already running on a system. Nevertheless, exploiting these vulnerabilities allows the malware to obtain an almost permanent foothold on infected systems by gaining the ability to survive server OS reinstalls by hiding in the hardware's firmware.The first of the flaws uncovered by Eclypsium researchers is not an actual vulnerability in the firmware's code, but in the configuration of some Supermicro products.Researchers say that some of these products come with firmware that uses an improper setting for the "Descriptor Region."The Descriptor Region is a security feature of Intel-based chipsets. This setting tells the chipset what areas of its own flash storage external parties can access to store data such as firmware or configuration files.According to Eclypsium researchers, some Supermicro products had an incorrectly set Descriptor Region that allowed software running on the OS (such as malware) to modify the Descriptor Region and then tamper with local firmware."Eclypsium researchers have observed vulnerable descriptor access controls through runtime examination of various server firmware models," the Eclypsium team wrote in a "This manual analysis uncovered multiple server models that allowed writes to the flash descriptor from host software. According to Supermicro, some of the products we reviewed date back to 2008 and are currently EOL and no longer supported."But while modifying the Descriptor Region setting may be possible on some Supermicro products, tampering with the local firmware isn't as easy as it sounds, as several security mechanisms prevent malicious actors from altering a computer or server's most important code.Here is where the second series of issues that the Eclypsium team discovered came into play."We have observed insecure firmware updates through runtime examination of various systems. This manual analysis uncovered that Supermicro X9DRi-LN4F+ and X10SLM-F systems did not securely authenticate firmware updates," the research team said."We confirmed this result by intentionally modifying the binary in official Supermicro firmware images and observing that the system firmware still accepted and installed the modified package."But the issues didn't stop here, and the Eclypsium team also noted a lack of anti-rollback protections for firmware images.This anti-rollback protection is crucial for situations where the vendor checks for firmware authenticity.A firmware anti-rollback protection would prevent attackers from replacing newer firmware with an older (legitimate) firmware image that contains flaws that attackers can exploit and gain a foothold on all-of-a-sudden vulnerable systems.Eclypsium says it notified Supermicro about all the issues they discovered in the firmware of their products back in January."Supermicro has been supportive of our efforts and prioritized understanding and mitigating the issues we have discovered," Eclypsium says,"For the current generation of products, Supermicro indicated that they have already implemented a signed firmware update for several products and are making this update generally available for all future systems."Similarly, for OEM customers who require rollback capability for their customized and locked firmware versions to ensure business continuity, Supermicro indicated that they are supporting anti-rollback as an option for their X11 generation firmware."The SPI flash descriptor is read-only on most boards and we are helping Supermicro identify specific models where this may be incorrectly set."For owners of Supermicro server hardware, Eclypsium has released instructions on how to check the descriptor access controls of their own systems.These procedures require installing and running the Bleeping Computer has sent a request for comment to Supermicro days before this article's publication. We asked Supermicro to confirm the Eclypsium research and inquired for a list of Supermicro platforms affected by the reported security issues, but we have not heard back before this article's publication time.Until Supermicro responds or publishes an official security advisory with a list of affected modules, Eclypsium CEO and Founder Yuriy Bulygin was kind enough to share with Bleeping Computer the list of Supermicro products they believe to be affected."For the missing UEFI update protections, it appears that a majority or all of X8, X9, X10 generation server products, and a majority of X11 generation server products are affected," Bulygin told Bleeping Computer via email. "We don’t know exact number of affected models but we found 1184 unique firmware images for at least 233 unique X8-X11 server models.""For the flash descriptor issue we found close to 500 firmware images with this issue which translates to about 110 different models (some of them may be old). The list is below:"