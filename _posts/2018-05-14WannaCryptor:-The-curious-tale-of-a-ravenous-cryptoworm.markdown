---
layout: post
title: WannaCryptor: The curious tale of a ravenous cryptoworm
date: 2018-05-14 12:01:10
tourl: https://www.welivesecurity.com/2018/05/14/wannacryptor-curious-tale/
tags: [NSA]
---
ä½ è¿˜è®°å¾—WnRaulporå¦‚ä½•è¿è¡Œå®ƒçš„ç¼ ç»•è¿‡ç¨‹å—ï¼Ÿè¿™æ˜¯ä¸€ä¸ªæ•…äº‹ï¼Œæ­ç¤ºäº†è®¸å¤šæœ‰è¶£çš„æƒ…èŠ‚çº¿åœ¨å…°èŠ±è •è™«çš„ä¼—å¤šæ›²æŠ˜å’Œæ›²æŠ˜ã€‚TuntTuttä½ æ— ç–‘å¬è¯´è¿‡WnAcRyporï¼ŒAka WaNaCyRyæˆ–WCRIPTï¼Œå¤šæ¬¡ï¼Œä½†ä»ç„¶å¯èƒ½æœ‰ä¸€äº›äº‹æƒ…é€ƒè„±äº†ä½ åœ¨æ—¥å¸¸å–§åš£çš„æ—¥å¸¸ç”Ÿæ´»ä¸­ã€‚è¿™é‡Œæœ‰ä¸€äº›å°ç‚¹å­å¸®åŠ©WaNaRyPrxorï¼Œå®é™…ä¸Šï¼Œä¸å®ƒæœ‰å…³çš„äººåœ¨ä¸€ä¸ªå¥½çš„æˆ–åçš„æ–¹å¼ä¸­è„±é¢–è€Œå‡ºã€‚é¦–å…ˆï¼Œä¸åƒå®ƒå·²ç»æ‰«æäº†è®¸å¤šæœ‰ç«¯å£445ï¼ˆä¼ ç»Ÿä¸Šä¸SMBç›¸å…³è”çš„æœºå™¨ï¼‰çš„å› ç‰¹ç½‘ï¼Œæ”»å‡»è€…åˆ©ç”¨äº†SMBç¼ºé™·å’ŒWã€‚Enterå®‰è£…å¦ä¸€ä¸ªå·¥å…·ï¼ŒåŒå³°è„‰å†²æ˜Ÿï¼Œè¢«è®¤ä¸ºæ˜¯ä»ç¾å›½å›½å®¶å®‰å…¨å±€å·æ¥çš„ã€‚è¿™ä¸ªåé—¨ä¸ºä¸»è¦çš„æœ‰æ•ˆè½½è·é“ºå¹³äº†é“è·¯ï¼Œä¸€æ—¦è¢«æ¤å…¥å’Œæ‰§è¡Œï¼Œæ–‡ä»¶å°±è¢«åŠ å¯†äº†ã€‚é‡è¦çš„æ˜¯ï¼Œå¾®è½¯å‘å¸ƒäº†ä¸€ä¸ªWnAcRyPrtuorè •è™«çš„åŠŸèƒ½ï¼Œä»è¿‡å»çš„å‡ å¤©èµ·ï¼Œå°±æœ‰ä¸€äº›è¯¡å¼‚çš„æŠ€æœ¯å›å£°ï¼ˆä¸ç®¡æ€ä¹ˆè¯´ï¼‰ã€‚äº‹å®ä¸Šï¼Œå®‰å…¨äººå‘˜é¢„æœŸï¼Œå‹’ç´¢å°†ä¸è‡ªæˆ‘ç¹æ®–è •è™«é…å¯¹ï¼Œä»¥å¤§å¤§å¸®åŠ©å’Œæ€‚æ¿ä¸»è¦æœ‰æ•ˆè½½è·çš„ä¼ æ’­ã€‚å°±åƒè€å­¦æ ¡çš„è •è™«ä¸€æ ·ï¼Œåœ¨2001è®¤ä¸ºä»£ç çº¢è‰²ï¼Œä¸€æ—¦åœ¨æœºå™¨ä¸­ï¼ŒWnRaCyporåˆ©ç”¨å®ƒçš„è •è™«åŠŸèƒ½æ¥åœ¨æœ¬åœ°ç½‘ç»œå’Œå¼€æ”¾çš„äº’è”ç½‘ä¸Šæä¾›å…¶ä»–è„†å¼±çš„è®¾å¤‡ã€‚ä¸€æ—¦å¦ä¸€å°è¢«æ›å…‰çš„æœºå™¨è¢«å‘ç°å¹¶è¢«åŒæ ·çš„æœªä¿®è¡¥çš„SMBæ¼æ´æ‰€æŠ˜è¡·ï¼Œå®ƒå°±è¢«æ»¥ç”¨äº†ï¼Œå› ä¸ºå®ƒç»§ç»­å‘å‰æ¨è¿›ï¼Œç»§ç»­ç ´åè®¡ç®—æœºã€åŠ å¯†æ–‡ä»¶å’Œè¦æ±‚èµé‡‘çš„æ¶æ€§å¾ªç¯ã€‚David Harleyæœ€è¿‘ï¼Œäº‹å®ä¸Šï¼Œé‡‘é’±æ–¹é¢çš„å¤±è´¥ï¼Œä¸ºæ”»å‡»è€…è€ƒè™‘åˆ°è¿åŠ¨çš„ç¨‹åº¦å’Œå®ƒæ‰€é€ æˆçš„æŸå®³çº¦300000å°æœºå™¨å¦¥åï¼Œæ¯ä¸ªæ½œåœ¨çš„äº¤æ¢300ç¾å…ƒï¼ˆæˆ–ä¸‰å¤©åï¼Œ600ç¾å…ƒï¼‰çš„è§£å¯†å¯†é’¥ã€‚å½“å°˜åŸƒè½å®šæ—¶ï¼Œä¸‰ä¸ªæ¯”ç‰¹å¸é’±åŒ…çš„è¿è¥å•†ä¸WnRayPyrorç›¸å…³ï¼Œè¿„ä»Šä¸ºæ­¢è¿˜ä¸çŸ¥é“ï¼Œé¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œè¿™ä¸WangRyPaulorçš„ä¸€äº›å…¶ä»–æ€ªç™–ç›¸ç»“åˆï¼Œä¿ƒä½¿è®¸å¤šå®‰å…¨ä»ä¸šäººå‘˜ç›¸ä¿¡æ¶æ„è½¯ä»¶ä»æ¥æ²¡æœ‰æ‰“ç®—æˆä¸ºä¸€ä¸ªé‡‘é’±æ¬ºè¯ˆçš„é©¬èµ«ã€‚å—¯ã€‚å–è€Œä»£ä¹‹çš„æ˜¯ï¼Œå®ƒè¢«ç§°ä¸ºä¸€ä¸ªç²¾å·§çš„ç£ç›˜é©±åŠ¨å™¨ï¼Œæˆ–è€…å®ƒå¯èƒ½è¢«è®¡åˆ’ä¸ºä¸€ä¸ªå°æ“ä½œï¼Œæœ€ç»ˆå¯¼è‡´å¤±æ§ã€‚ä¸ä»…ä»…æ˜¯åœ¨Matrixï¼Œæ‰€æœ‰æœ‰å¼€å§‹çš„ä¸œè¥¿éƒ½æœ‰ä¸€ä¸ªç»“æŸã€‚ä¸ç®¡æ€æ ·ï¼Œä¸‡èŠ±ç­’çš„çˆ†å‘æ˜¯å¦‚ä½•åœæ­¢çš„ï¼Ÿåœ¨ä¸€ä¸ªæœ€å…·åé«˜æ½®çš„æ—¶å°šä¸­ï¼ŒWannaCryptoråœ¨è‹±å›½è¢«ä¸€ä¸ª22å²çš„æ¶æ„è½¯ä»¶åˆ†æå‘˜æ½œå…¥åˆ°ä»£ç çš„æ ·æœ¬ä¸­ï¼Œæ³¨æ„åˆ°äº†å®ƒçš„è¡Œä¸ºã€‚ç ”ç©¶äººå‘˜ï¼Œä¸€ä¸ªåå«Marcus Hutchinsçš„AKAï¼Œåšäº†ä¸€äº›å¥‡æ€ªçš„è½¬æŠ˜ï¼Œè®¸å¤šå®‰å…¨å…±åŒä½“æˆå‘˜Hutchinsçš„æƒŠè®¶ï¼Œäº8æœˆåˆåœ¨æ‹‰æ–¯ç»´åŠ æ–¯æœºåœºè¢«æ•ã€‚å“¦ï¼Œè®©æˆ‘ä»¬ä¸è¦ã€‚å¸Œæœ›ä¸æ˜¯ä¸€ç§ç­–ç•¥ï¼Œæ­£å¦‚ä¸€äº›æ°å‡ºçš„äººï¼ŒåŒ…æ‹¬ç”µå½±å¯¼æ¼”è©¹å§†æ–¯Â·å¡æ¢…éš†æ‰€è¯´çš„é‚£æ ·ã€‚ç›¸åï¼Œè®©æˆ‘ä»¬
Do you still remember how WannaCryptor ran its – winding – course? It was a tale that revealed a number of intriguing plot lines amid the ransomworm’s numerous twists and turns.tttttttttttttttYou’ve no doubt heard about WannaCryptor, aka WannaCry or WCrypt, many times before, but there may still be things that have escaped you in the general hubbub of daily life. Here are a few tidbits that helped make WannaCryptor – and, indeed, the people involved with it in a good or bad way – stand out.First, unlike many of its Having scanned the internet for machines with port 445 (conventionally associated with SMB) open, the attackers exploited the SMB flaw and went on to install another tool, DoublePulsar, thought to have been stolen from the NSA. This backdoor paved the way for the main payload that, once implanted and executed, encrypted the files.Importantly, Microsoft released a WannaCryptor’s worm-esque functionality had some eerie echoes of techniques from the days of yore (in computer terms, anyway). In fact, security folks had expected that ransomware would come to be paired with self-propagating worms to greatly aid and abet the main payload’s spread. Much like old-school worms – think Code Red in 2001, Once in a machine, WannaCryptor leveraged its worm functionality to feed on other vulnerable devices within the local network and on the open internet. As soon as another exposed machine was found and compromised courtesy of the same unpatched SMB loophole, it was abused for “paying it forward”, continuing the vicious cycle of compromising computers, encrypting files, and demanding ransom.Speaking of the main payload, ESET Senior Research Fellow David Harley recently In fact, the money side of things failed precipitously for the attackers considering the extent of the campaign and the damage it wrought – some 300,000 machines compromised, each in potential exchange for $300 (or, after three days, $600) for the decryption key. When the dust settled, the operators of the three Bitcoin wallets associated with WannaCryptor – to date unknown, by the way – This, combined with some other quirks of WannaCryptor, has prompted many security practitioners to believe that the malware was never intended to be a money-grubbing machine. Instead, it has been called an elaborate disk trasher, or it may have been planned as a small operation that ended up getting out of hand.It’s not only in the Matrix that “everything that has a beginning has an end” (I left out “Neo” on purpose here). How did the WannaCryptor outbreak stop – for the most part, anyway? In a most anti-climactic fashion – with a “switch“.As WannaCryptor was being foisted on users throughout the world, a 22-year-old malware analyst from England dived into samples of the code, noticing something peculiar about its behavior. The researcher, a Marcus Hutchins aka Then, doing what those who track In an odd twist – and much to the astonishment of many members of the security community – Hutchins was arrested at the Las Vegas airport in early August on With WannaCryptor firmly in the rearview mirror, let’s hope … er, no, let’s not. “Hope is not a strategy,” as some prominent people, including film director James Cameron, have averred. Instead, let’s 