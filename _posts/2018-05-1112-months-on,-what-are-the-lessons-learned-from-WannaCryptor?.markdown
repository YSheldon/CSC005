---
layout: post
title: 12 months on, what are the lessons learned from WannaCryptor?
date: 2018-05-11 12:01:03
tourl: https://www.welivesecurity.com/2018/05/11/lessons-learned-wannacryptor/
tags: [exploit]
---
æ—¶é—´é£é€ï¼å°±åƒæ˜¨å¤©ä¸€æ ·ï¼Œä¸€ä¸ªæ–°çš„è¿„ä»Šä¸ºæ­¢é²œä¸ºäººçŸ¥çš„æ¶æ„è½¯ä»¶åœ¨å…¨çƒRunsWATION STATTTTTTTTTTTTä¸­è·å¾—äº†åäººåœ°ä½ï¼Œå‡ ä¹å·²ç»æŒç»­äº†ä¸€å¹´ï¼Œå› ä¸ºWnAcRaultor RaSuMeSuffthoRMï¼ˆä¹Ÿç§°ä¸ºWANACRYï¼‰å¹¶è¢«ESET ASæ£€æµ‹åˆ°ã€‚å…¨çƒçˆ†å‘æ˜¾ç„¶æ˜¯ä¸€ä¸ªå¯æ•™çš„æ—¶åˆ»ï¼Œå› ä¸ºé€ æˆå…¶å·¨å¤§è¶³è¿¹çš„å› ç´ ä¹Ÿæ­ç¤ºäº†ä¸€äº›å¼ºæœ‰åŠ›çš„æ•™è®­ã€‚æˆ‘ä»¬ä¼šç»™ä½ ä¸€ä¸ªç®€å•çš„ä»‹ç»æˆ–é‡å¤ï¼Œå¯¹äºé˜²å®ˆé˜Ÿå‘˜æ¥è¯´ï¼Œæ´æ˜¯è¦æ’ä¸Šçš„ã€‚ç®€å•åœ°è¯´ï¼Œä½†ä¸åŒçš„æ˜¯ï¼Œå®ƒæ˜¯ä¸€ä¸ªè¡¥ä¸æˆ–æ¯ç­ä¸–ç•Œï¼Œå°¤å…¶æ˜¯å…³äºå·²çŸ¥å®‰å…¨ç¼ºé™·çš„ä¿®å¤ã€‚ç„¶è€Œï¼Œè®¸å¤šç»„ç»‡çš„ä¼˜ç‚¹æ˜¯ä½¿ä»–ä»¬çš„ç³»ç»Ÿä¿æŒç°çŠ¶ã€‚å¯ä»¥è‚¯å®šçš„æ˜¯ï¼Œä¸šåŠ¡ç°å®é€šå¸¸æ„å‘³ç€åœ¨ä¼ä¸šç¯å¢ƒä¸­å®‰è£…ä¿®å¤ä¸æ˜¯ä¸€ä»¶å®¹æ˜“çš„äº‹æƒ…ã€‚ä¸ç®¡è¿™ä¸ªé•¿æœŸé—®é¢˜çš„åŸå› æ˜¯ä»€ä¹ˆï¼Œç»“æœéƒ½æ˜¯ä¸€æ ·çš„ï¼šæ¯ä¸€ä¸ªè¡¥ä¸ç­‰å¾…éƒ¨ç½²ï¼Œä¸€äº›å—å®³è€…è¢«å‡»ä¸­ä¸æ˜¯å› ä¸ºä»–ä»¬æ²¡æœ‰ä¿®è¡¥ï¼Œè€Œæ˜¯å› ä¸ºä¿®å¤æ˜¯ä¸å¯èƒ½çš„ï¼Œæˆ–è€…è‡³å°‘æ˜¯æ£˜æ‰‹çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä»–ä»¬è¿è¡Œçš„ç³»ç»Ÿå·²ç»è¾¾åˆ°å¯¿å‘½çš„å°½å¤´ï¼Œåœ¨æ²¡æœ‰ä¸»æµæ”¯æŒçš„æƒ…å†µä¸‹ï¼Œæ²¡æœ‰è¡¥ä¸å¯ç”¨ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå–ä»£è¿‡æ—¶çš„å’Œé—ç•™ç³»ç»Ÿåº”è¯¥æ˜¯é¦–è¦å…³æ³¨çš„é—®é¢˜ã€‚å¦‚æœè¿™æ˜¯ä¸å¯èƒ½ç«‹å³ï¼Œæ—§çš„ç³»ç»Ÿåº”è¯¥æ˜¯ï¼Œåªè¦æœ‰å¯èƒ½ï¼Œå­¤ç«‹åœ¨è‡ªå·±çš„ç½‘ç»œæ®µã€‚äº‹å®ä¸Šï¼Œå®‰å…¨æ„Ÿçš„ç½‘ç»œåˆ†å‰²ä¸€èˆ¬å¯ä»¥ç¡¬åŒ–å…¬å¸çš„é˜²å¾¡ï¼Œå°¤å…¶æ˜¯å¯¹æ¶æ„è½¯ä»¶è¡¨ç°å‡ºè •è™«æ ·è¡Œä¸ºï¼Œå¦‚WANRACYPYTOçš„æƒ…å†µã€‚R.é€šè¿‡ä»…å…è®¸æŸäº›åŠŸèƒ½æ®µè¿›å‡ºåŠŸèƒ½æ®µå’Œå½¼æ­¤ä¹‹é—´ï¼Œä»¥åŠåœ¨ä¾§å‘è¿åŠ¨æœŸé—´ç¡®ä¿æ•°æ®ï¼Œå³ä½¿åœ¨ä¸€ä¸ªæ®µä¸Šå‘ç”Ÿè£‚å£ï¼Œåˆ™æš´éœ²æ˜¯æœ‰é™çš„ï¼Œå¹¶ä¸”åŒ…å«æŸåã€‚ä½œä¸ºä¸€ä¸ªé¢å¤–çš„å¥½å¤„ï¼Œç½‘ç»œåˆ†åŒºå…è®¸æ›´å¼ºå¤§çš„è®¿é—®æ§åˆ¶ï¼Œåªå¯¹éœ€è¦å®ƒçš„é›‡å‘˜é™åˆ¶å­ç½‘ç»œçš„è®¿é—®ï¼Œå¹¶ä¸”åªå…è®¸ä»–ä»¬çœŸæ­£éœ€è¦çš„æƒé™ã€‚é€šè¿‡å¾®è½¯æ–‡ä»¶å…±äº«æœåŠ¡å™¨Mçš„é•¿æœŸè¿‡æ—¶çš„ç¬¬ä¸€ç‰ˆæœ¬ä¼ æ’­æ´»åŠ¨ã€‚ASSEAGEå—ï¼ˆSMBV1ï¼‰åè®®ï¼Œæ‰€ä»¥ä¸ç”¨è¯´ï¼Œåè®®çš„å¤è€ç‰ˆæœ¬åº”è¯¥å®Œå…¨ç¦ç”¨ï¼Œå› ä¸ºå¼ºå¤§çš„ç½‘ç»œå®‰å…¨æ§åˆ¶æ¶‰åŠç¡®ä¿æ‰€æœ‰æœºå™¨éƒ½é…å¤‡äº†å®‰å…¨è½¯ä»¶ï¼Œè‡ªç„¶ï¼Œéœ€è¦ä¿æŒæœ€æ–°çš„ã€‚ä¸€ä¸ªå¥å£®çš„åæ¶æ„è½¯ä»¶å¥—ä»¶åœ¨ç½‘ç»œæ€æˆ®é“¾çš„ä¸åŒé˜¶æ®µå¼•å…¥äº†äº’è¡¥çš„é˜²å¾¡å±‚ï¼Œå¸®åŠ©ä¿æŠ¤ç”šè‡³æŠµå¾¡è¡¥ä¸å°šæœªå‘å¸ƒæˆ–éƒ¨ç½²çš„ç¼ºé™·ï¼Œç”šè‡³å¼€å‘å‡ºæ¥ã€‚å¦‚ä¸Šæ–‡æ‰€è¿°ï¼Œä½†ç»å¯¹ä¸æ˜¯æœ€ä¸é‡è¦çš„å¤‡ä»½ã€‚äº‹å®ä¸Šï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¤‡ä»½åªæ˜¯ä½œä¸ºæœ€åçš„æªæ–½ï¼Œåœ¨æ‰€æœ‰çš„ç½‘ç»œé˜²å¾¡è¢«ç ´ååï¼Œä½†è¿™çªæ˜¾äº†å®ƒä»¬çš„é‡è¦æ€§ã€‚äº‹å®ä¸Šï¼Œå¦‚æœæœ€åçš„æƒ…å†µå‘ç”Ÿï¼Œä¸€ä¸ªæˆåŠŸçš„äº‹ä»¶å“åº”å’Œæ¢å¤å°†å–å†³äºä¸€ä¸ªç»è¿‡è€ƒéªŒçš„å¤‡ä»½ç­–ç•¥ã€‚è¿™ä¸ªä¾‹ç¨‹éœ€è¦åŒ…æ‹¬ç»å¸¸å°†æ•°æ®å¤åˆ¶åˆ°é€šå¸¸ç¦»çº¿çš„åª’ä½“ä¸Šï¼Œä»è€Œä½¿å®ƒä»¬å…å—æ¶æ„è½¯ä»¶çš„å½±å“ã€‚è¿™æ ·ä¸€æ¥ï¼Œå°±ä¸å¿…è€ƒè™‘å‘æ”»å‡»è€…æå‡ºçš„è¦æ±‚ï¼Œå³æˆ‘ä»¬ä¸€èˆ¬ä¸è€ƒè™‘é¢„é˜²æªæ–½æœ‰å¤šä¹ˆä¸¥æ ¼çš„æƒ³æ³•ï¼Œåœ¨å¤„ç†ä¸¥é‡äº‹ä»¶çš„åæœæ—¶ï¼Œå®ƒä»¬è¿œä¸å¦‚æ‰€æœ‰éœ€è¦åšçš„å›°éš¾ã€‚è¿™å¥å¤è€çš„è°šè¯­æ˜¾ç„¶ä»ç„¶æ˜¯çœŸå®çš„ï¼Œå³ä½¿åœ¨è‰²è°ƒå’Œï¼ˆæƒ³è¦ï¼‰å“­æ³£ï¼ˆPorï¼‰å·²ç»å…¨éƒ¨æ¶ˆäº¡çš„æ—¶å€™ï¼Œè¿™è‚¯å®šè®©ä½ æ„Ÿåˆ°æƒŠå¥‡ï¼šç©¶ç«Ÿæ˜¯ä»€ä¹ˆä½¿å‰¥å‰Šâ€œæ°¸æ’ä¹‹è“â€å‘ç”Ÿäº†ï¼Ÿä¸çŸ¥é“äº†ï¼Œæˆ‘ä»¬å·²ç»è¢«æ©åŸ‹äº†ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬è‡ªå·±çš„Ondrej Kuboviå‘¢ï¼Ÿä¸å¹¸çš„æ˜¯ï¼Œå‘ç°ä¸€ä¸ªäººä»ç„¶ä¸èƒ½æ»¡è¶³ä½ çš„å¥½å¥‡å¿ƒï¼Œä¸€å®šè¦è¯»ä¸‹æˆ‘ä»¬ä¸‹å‘¨å¯èƒ½ä¸çŸ¥é“çš„å…³äºWaNaRyporçš„äº‹å®ã€‚
Time does fly! It feels like only yesterday that a new strain of hitherto little-known malware achieved celebrity status among global ransomware campaignstttttttttttttttIt’s already been a year, almost to the day, since the WannaCryptor ransomware cryptoworm – also known as WannaCry and detected by ESET as The global outbreak was clearly a teachable moment, as the factors that contributed to its large footprint also revealed some powerful lessons. We’ll spare you an introduction or a repetition of the Put simply, for the defenders, holes are there to be plugged. Put just as simply but differently, it’s a “patch-or-perish world”, especially regarding fixes for known security flaws. The merits of However, many organizations struggle to keep their systems current. To be sure, business realities often mean that installing fixes across enterprise environments is no easy task. Whatever the cause of this perennial problem, however, the upshot is the same: with every patch waiting to be deployed, the Some victims were hit not because they hadn’t patched, but because a fix was impossible, or at least intractable. That is, they were running systems that had reached the end of their lifespans and, in the absence of mainstream support, no patch was available. In that case, replacing outdated and legacy systems should be the overarching concern. If that isn’t possible immediately, the old systems should be, whenever possible, isolated on their own network segments.In fact, security-minded network segmentation in general can harden a firm’s defenses, especially against malware exhibiting worm-like behavior as was the case with WannaCryptor. By permitting only certain traffic in and out of functional segments and between one another, as well as by securing data during lateral movements, even if a breach does occur on one segment, the exposure is limited and the damage is contained. As an added benefit, network compartmentalization allows for stronger access controls, restricting access to sub-networks only to employees who need it, and only with permissions that they really need.The campaign propagated via the long-outdated, first version of Microsoft’s file-sharing Server Message Block (SMBv1) protocol, so it goes without saying that the protocol’s ancient version should be disabled altogether – as Robust cybersecurity controls involve ensuring that all machines are fitted with security software that, naturally, needs to be kept up-to-date. A robust anti-malware suite incorporates complementary layers of defense that kick in at different stages of the cyber-kill-chain, helping protect even against flaws for which a patch has not been released or deployed – or even developed. As reported in Last, but absolutely not least – backups. Indeed, in this scenario, backups only come into play as a last-ditch measure after all the cyberdefenses are breached, but that happens to underscore their importance. Indeed, if the worst comes to the worst, a successful incident response and recovery will hinge on a tried-and-tested backup strategy. This routine needs to include making frequent copies of data to media that are normally offline, thus keeping them safe from the malware’s reach. That way, there is no need to ponder the possibility of giving in to the attackers’ demands – an idea that we generally Regardless of how demanding precautions are, they are nowhere near as difficult as all that needs to be done when dealing with the consequences of a serious incident. This old adage clearly continues to hold true even after the hue and (Wanna)Cry(ptor) has all but died down.Which surely makes you wonder: whatever happened to the exploit – EternalBlue – that enabled the campaign in the first place? Wonder no more, we’ve got that covered. However, our own Ondrej Kubovi? finds that, sadly, that one is Should that still not satiate your curiosity, be sure to read our piece about facts you may not have known about WannaCryptor next week.tttttttttttttttttttttttttt